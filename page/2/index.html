<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>走难</title><meta name="author" content="Func"><meta name="copyright" content="Func"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Func的个人博客">
<meta property="og:type" content="website">
<meta property="og:title" content="走难">
<meta property="og:url" content="https://fang-tech.github.io/page/2/index.html">
<meta property="og:site_name" content="走难">
<meta property="og:description" content="Func的个人博客">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://raw.githubusercontent.com/fang-tech/Pic/main/img/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20250709003827.jpg">
<meta property="article:author" content="Func">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/fang-tech/Pic/main/img/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20250709003827.jpg"><script type="application/ld+json"></script><link rel="shortcut icon" href="https://raw.githubusercontent.com/fang-tech/Pic/main/img/pngtree-round-logo-with-mountains-and-water-vector-png-image_7031662.png"><link rel="canonical" href="https://fang-tech.github.io/page/2/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          const mediaQueryDark = window.matchMedia('(prefers-color-scheme: dark)')
          const mediaQueryLight = window.matchMedia('(prefers-color-scheme: light)')

          if (theme === undefined) {
            if (mediaQueryLight.matches) activateLightMode()
            else if (mediaQueryDark.matches) activateDarkMode()
            else {
              const hour = new Date().getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            mediaQueryDark.addEventListener('change', () => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else {
            theme === 'light' ? activateLightMode() : activateDarkMode()
          }
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.json","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '走难',
  isHighlightShrink: false,
  isToc: false,
  pageType: 'home'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="https://raw.githubusercontent.com/fang-tech/Pic/main/img/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20250709003827.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">131</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">271</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">48</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/java/"><i class="fa-fw fas fa-music"></i><span> Java</span></a></li><li><a class="site-page child" href="/Spring/"><i class="fa-fw fas fa-video"></i><span> Spring</span></a></li></ul></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header" style="background-image: url(https://raw.githubusercontent.com/fang-tech/Pic/main/img/psc.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">走难</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/java/"><i class="fa-fw fas fa-music"></i><span> Java</span></a></li><li><a class="site-page child" href="/Spring/"><i class="fa-fw fas fa-video"></i><span> Spring</span></a></li></ul></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="site-info"><h1 id="site-title">走难</h1><div id="site-subtitle"><span id="subtitle"></span></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts nc" id="recent-posts"><div class="recent-post-items"><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2025/07/08/Project/Big-Market/%E8%BF%87%E7%A8%8B%E7%AC%94%E8%AE%B0/18.%20%E9%A2%86%E5%8F%96%E6%B4%BB%E5%8A%A8%E6%89%A3%E5%87%8F%E8%B4%A6%E6%88%B7%E9%A2%9D%E5%BA%A6/" title="无标题">无标题</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2025-07-08T15:03:04.840Z" title="发表于 2025-07-08 23:03:04">2025-07-08</time></span></div><div class="content">实现了什么service分层将用户抽奖流程分成  用户添加额度  领取活动 (扣减互动账户额度) 执行抽奖策略 抽奖结果落库  这节课主要实现的是第二个部分, 领取活动, 同时我们将原先实现的进行了分层, 以和领取活动部分进行切分  我们可以将这部分分成两部分 创建充值订单, 为用户增加抽奖次数, 这里创建的是活动订单记录, 表明有人参与了活动, 获取了额度, 这个时候聚合对象传递的就有添加的次数 这里的订单更多的是起到的记录的作用, 在数据库中记录用户获取次数额度的获取记录 同时将额度的增加落库   创建用户额度扣减订单, 如果用户有额度创建订单, 创建订单, 这里的订单是执行抽奖的消耗, 是一个下单记录    账户额度的扣减和恢复 在之前我们只有一个表的时候, 我们就需要在对应的时间执行恢复额度操作 现在我们创建了月账户表, 日账户表, 两个表分别对应了用户这个月 &#x2F; 天可用的额度 那么在这个时候, 如果我们要执行用户账户额度的扣减 将总账户, 月账户, 日账户, 三个账户中的额度都执行扣减 总账户的中的镜像月余额和镜像日余额里面的值, 是我们能最多分配给这个月&#...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2025/07/08/Project/Big-Market/%E8%BF%87%E7%A8%8B%E7%AC%94%E8%AE%B0/17.%20%E7%94%A8%E4%BA%8E%E9%A2%86%E5%8F%96%E6%B4%BB%E5%8A%A8%E5%BA%93%E8%A1%A8%E8%AE%BE%E8%AE%A1/" title="无标题">无标题</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2025-07-08T15:03:04.839Z" title="发表于 2025-07-08 23:03:04">2025-07-08</time></span></div><div class="content">实现了什么库表设计 因为账户可用抽奖次数, 为了应对复杂的实际需求, 我们是为一个账户设置了日次数, 月次数, 总次数的限制, 这个时候如果我们在扣减额度的时候是扣减这张账户表中的次数, 则还需要在特定的时间恢复库存   这个时候我们还要额外记录我们要恢复的次数数量 (因为这个次数是可能会发生变化的, 比如有什么奖励是增加最大抽奖次数)  所以我们干脆直接再设置一个表, 用于存储用户可用的次数的表, 我们在这个表中执行扣减, 原先的表就相当于一个镜像表(就像我们记录了最大生命值一样, 然后在新的游戏中扣减生命值, 新的游戏再恢复)  TODO 扣减额度的库表任务很明显和用户订单需要在一个事务中完成 (通过聚合对象 + 事务实现?) 获取到订单了以后, 通过抽奖策略计算, 我们得到抽奖奖品 将抽到的奖品通过发送MQ发送出去 维护一个task表, 依靠task表的备份, 我们通过定时job扫描task表, 重新发送未成功的MQ消息    </div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2025/07/08/Project/Big-Market/%E8%BF%87%E7%A8%8B%E7%AC%94%E8%AE%B0/16.%20%E5%BC%95%E5%85%A5MQ%E5%A4%84%E7%90%86%E6%B4%BB%E5%8A%A8SKU%E5%BA%93%E5%AD%98%E4%B8%80%E8%87%B4%E6%80%A7/" title="无标题">无标题</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2025-07-08T15:03:04.837Z" title="发表于 2025-07-08 23:03:04">2025-07-08</time></span></div><div class="content">实现了什么实现的内容 和前面实现策略奖品扣减一样实现了加锁的在缓存中的扣减库存操作, 同时延迟队列延迟将数据库更新操作加入队列以减轻数据库压力, 数据库定时异步更新  额外加上了MQ, 如果缓存中剩余库存扣减至0, 直接清空队列(延时队列和阻塞队列), 并发送请求将数据库中的剩余库存清空至0  对于并发量很高的情况, 比如秒杀这种情景, 通过消息队列能有效减少对数据库的操作数量   填充实现了责任链中的具体的过滤逻辑和对于责任链的组装   学到了什么库存扣减流程 算是重温了一遍在第一阶段中的库存扣减操作, 同时加上了MQ额外处理库存变成0的情况  预处理 预热, 将sku商品的数量加载到redis缓存中  库存扣减 责任链过滤  用户发送请求扣减库存 -&gt; skuRecahrgeCard实体对象(商品充值实体) -&gt; 责任链过滤请求(确保请求是正确, 需要被响应的请求) -&gt; 活动状态是open -&gt; 在活动时间内 -&gt; 活动sku库存数量 &gt; 0 -&gt; 扣减库存校验责任链 (尝试进行扣减操作, 确保扣减成功, 这种时候才会返回订单号) ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2025/07/08/Project/Big-Market/%E8%BF%87%E7%A8%8B%E7%AC%94%E8%AE%B0/15.%20%E6%B4%BB%E5%8A%A8%E6%8A%BD%E5%A5%96%E6%B5%81%E7%A8%8B%E5%AE%9E%E7%8E%B0/" title="无标题">无标题</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2025-07-08T15:03:04.836Z" title="发表于 2025-07-08 23:03:04">2025-07-08</time></span></div><div class="content">实现了什么 这节课主要实现了活动抽奖的下单的整个流程   为活动抽奖的下单装配了责任链, 用于过滤活动下单动作 活动的库存时间校验 活动sku库存   为下单这个操作实现了操作的事务一致性, 以及幂等性  学到了什么如何保证一个多部份组成的订单是事务一致的聚合对象 通过将多部份组合成一整个整体- 聚合对象 - 订单 我们通过操作和管理, 并通过这个对象进行数据库操作, 保证了成员数据一致性  事务上的一致性 我们已经传进来了一个订单聚合对象  分库分表上的一致性 为用户创建路由键 通过这个路由键, 我们能保证对于一个用户, 他的订单相关的操作都会被路由到同一个数据库中操作, 这样我们就能更方便得保证事务一致性 而不需要分布式的事务一致性, 分布式的事务一致性的保证是安全度更低, 效率更低的方法    编程式事务 : TransactionTemplate TransactionTemplate 是Spring提供用于事务管理的Bean, 比声明式的(@Transactional) 更加地灵活, 颗粒度更小   这个Bean是怎么保证事务一致性的  1234567891011121...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2025/07/08/Project/Big-Market/%E8%BF%87%E7%A8%8B%E7%AC%94%E8%AE%B0/14.%20%E6%8A%BD%E5%A5%96%E6%B4%BB%E5%8A%A8%E8%AE%A2%E5%8D%95%E6%B5%81%E7%A8%8B%E8%AE%BE%E8%AE%A1/" title="无标题">无标题</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2025-07-08T15:03:04.833Z" title="发表于 2025-07-08 23:03:04">2025-07-08</time></span></div><div class="content">这节做了什么 这节主要是创建了活动抽奖的主要框架, 这个框架和strategy那边的框架其实类似   创建各个实体类 创建值对象 活动状态值对象 订单状态值对象   创建聚合对象 活动仓储层 服务层 : 我们主要在这个位置实现业务逻辑 单一功能接口IRaffleOrder : 创建订单接口 AbstractRaffleActivity : 用于定义活动抽奖的过程 RaffleActivityService extends AbstractRaffleActivityService : 实现抽奖的过程中的各个组件    学到了什么DDD架构下的接口等的编排 接口定义单一职责的功能  抽象类定义某些复杂的过程 继承抽象类的服务类实现抽象类中的各个组件  DDD中的各种类别的类VO对象 Value Object 值对象   与VO对象相对的就是实体对象, 这两者的核心区别是 VO对象没有唯一ID, 里面包含了很多通用的信息, 一般来说就是一个枚举类, 相等判断基于所有的值 不同的Entity即使值相同, 但是唯一ID不同, 也是不一样的实体, 但是但对于VO对象来说就算不是, 相等判断...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2025/07/08/Project/Big-Market/%E8%BF%87%E7%A8%8B%E7%AC%94%E8%AE%B0/12.%20%E4%B8%8D%E8%B6%85%E5%8D%96%E5%BA%93%E5%AD%98%E8%A7%84%E5%88%99%E5%AE%9E%E7%8E%B0/" title="无标题">无标题</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2025-07-08T15:03:04.832Z" title="发表于 2025-07-08 23:03:04">2025-07-08</time></span></div><div class="content">需求说明我们现在需要实现库存的扣减, 同时为了加速, 我们需要将这个扣减的过程放到redis中进行, 并通过锁机制保证不超卖. 同时实现异步的定时地执行数据库中数据更新(延时队列 + 定时任务) 业务流程 Before  将所有奖品的库存数据装配至redis缓存中  一条删减信息在业务中经过的流程redis中删减 -&gt; 删减成功 -&gt; 是否超卖 -&gt; 没有超卖 -&gt; 延迟队列 -&gt; 定时任务数据库修改数据   Redis的作用 缓存 将库存的信息加载进内存中, 让用户面向的数据实际上是redis缓存中的数据, 这样由磁盘IO变为内存IO, 加快了处理速度 同时减小了数据库的负载, 不用频繁地获取和释放连接   加锁兜底 对已经执行过获取的奖品在缓存中进行加锁记录(strategyId_awardId_surplus), 这样无论发生了什么会导致数据异常的情况, 我们都不会发生超卖事件. 已经出现过的surplus剩余数量我们都会记录下来, 哪怕数据错误恢复, 多加了库存数量, 我们在访问到这个库存数量的时候, 也会因为这个库存数量我们已经加过锁, 所...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2025/07/08/Project/Big-Market/%E8%BF%87%E7%A8%8B%E7%AC%94%E8%AE%B0/11.%20%E6%A8%A1%E6%9D%BF%E6%A8%A1%E5%BC%8F%E4%B8%B2%E8%81%94%E6%8A%BD%E5%A5%96%E8%A7%84%E5%88%99%20&amp;&amp;%20%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E6%80%BB%E7%BB%93/" title="无标题">无标题</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2025-07-08T15:03:04.830Z" title="发表于 2025-07-08 23:03:04">2025-07-08</time></span></div><div class="content">需求分析 在上一节实现了规则树模型的结构的设计, 这节我们在数据库中加上相关的关于规则树的配置的信息, rule_tree, rule_tree_node, rule_tree_node_line三个库表,    通过从其中查到的信息构建规则树 重构抽奖过程, 去掉filter的部分  重构的流程 : 在drawio的图中有详细的描述对于设计模式的总结建造者模式 Builder说明相较于构造模式是更灵活的一种创建一个新对象的方式, 我们能任意选择该类的字段进行创建一个新的对象, 而不再是需要传入全部的参数, 或者只能按照我们有的构造方法创建新的对象 疑惑但是其实这样的过程等同于使用setter在无参创建以后赋值, 这个设计模式主要是为了简化这个创建然后set的过程吗 责任链说明 执行的功能和switch case语句相似, 相当于我们构建一个case组, 并在其中选择性的break(也就是接管), 不break就会进入到下一个case(也就是放行) 我们会顺次执行链中的事件节点, 并在当前节点判断我们是需要在这个节点就返回结果(TAKE_OVER), 还是放行进入到下一个节点继续...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2025/07/08/Project/Big-Market/%E8%BF%87%E7%A8%8B%E7%AC%94%E8%AE%B0/10.%20%E6%8A%BD%E5%A5%96%E8%A7%84%E5%88%99%E6%A0%91%E6%A8%A1%E5%9E%8B%E7%BB%93%E6%9E%84%E8%AE%BE%E8%AE%A1/" title="无标题">无标题</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2025-07-08T15:03:04.829Z" title="发表于 2025-07-08 23:03:04">2025-07-08</time></span></div><div class="content">需求分析 情景 : 我们原先有rule_lock这个计数锁的抽奖中规则, 现在我们需要加上对于库存的核对, 如果从库存中获取失败, 我们直接返回幸运奖 使用原先框架的不足, 我们无法动态灵活地配置多种规则流程比如if (A -&gt; TAKE_OVER) -&gt; B else (A -&gt; ALLOW) -&gt; C这种动态且灵活的规则过滤流程  解决方法 通过决策树实现, 从根节点到叶子节点就是一条完整的规则过滤链 我们让树的能到达左节点的前提是上一个节点是ALLOW, 达到右节点的前提是TAKE_OVER(暂时这个章节是这样, 因为还涉及RuleLimitType的值的问题)  </div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2025/07/08/Java/Spring/Spring%20AI/Spring%20AI%E6%A6%82%E8%A7%88/" title="无标题">无标题</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2025-07-08T15:03:01.346Z" title="发表于 2025-07-08 23:03:01">2025-07-08</time></span></div><div class="content">Spring AI解决的核心问题 : Connecting your enterprise Data and APIs with AI Models Model 支持的模型类型  Chat Completion  Embedding  Text to Image  Audio Transcription  Text to Speech   Moderation    结构化输出: 将AI模型的输出能直接映射到需要的POJO类  支持主要的矢量数据库 (RAG)  允许模型请求执行客户端工具和函数(MCP)  AI模型评估  Advisor: 封装重复的生成式AI模式, 转换发送到和传出语言模型的数据, 并提供各种模型和用例的可移植性  ChatClient:   </div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2025/07/08/Java/Java%E8%BF%9B%E9%98%B6/JVM/JVM%E5%9F%BA%E7%A1%80-%E7%B1%BB%E5%AD%97%E8%8A%82%E7%A0%81/" title="无标题">无标题</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2025-07-08T15:03:01.340Z" title="发表于 2025-07-08 23:03:01">2025-07-08</time></span></div><div class="content">类字节码里有什么? 在初入JVM之际, 并且计算机的基础不够的前提下, 深入地了解JVM不会是一个明智的选择, 会在细节中迷失, 在旅途的开始, 更值得关注的是自子而下的结构以及各个部分的作用, 它们共同决定了什么  字节码文件的作用是什么 什么是字节码文件? 就是.class结尾的文件   class文件是java代码和cpu能执行的指令之间的中间层  java代码经过编译器以后, 会被编译成class文件 class文件再被交给JVM读取执行, 而JVM会根据具体的平台将字节码翻译成具体的指令   JVM已经不再支持Java了, 衍生出来了很多的基于JVM的编译语言  Kotlin : 通过kotlinc编译器 -&gt; 字节码文件 Groovy : 通过grooxy编译器 -&gt; 字节码文件    Class文件的结构属性 我们只会分析一个简单的案例, 从而知道一个class文件大概有什么内容  属性结构介绍 魔数和class文件版本 : 每个class文件的前四个字节被称为魔数, 值为(0xcafebabe), 它的作用是确定这个文件是一个class文件, 起到一个...</div></div></div></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/"><i class="fas fa-chevron-left fa-fw"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/#content-inner">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/14/#content-inner">14</a><a class="extend next" rel="next" href="/page/3/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="https://raw.githubusercontent.com/fang-tech/Pic/main/img/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20250709003827.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Func</div><div class="author-info-description">Func的个人博客</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">131</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">271</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">48</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/fang-tech"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/08/Project/Big-Market/%E8%BF%87%E7%A8%8B%E7%AC%94%E8%AE%B0/9.%20%E4%BD%BF%E7%94%A8%E8%B4%A3%E4%BB%BB%E9%93%BE%E5%A4%84%E7%90%86%E6%8A%BD%E5%A5%96%E8%A7%84%E5%88%99/" title="无标题">无标题</a><time datetime="2025-07-08T15:03:04.855Z" title="发表于 2025-07-08 23:03:04">2025-07-08</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/08/Project/Big-Market/%E8%BF%87%E7%A8%8B%E7%AC%94%E8%AE%B0/8.%20%E6%8A%BD%E5%A5%96%E4%B8%AD%E7%BD%AE%E8%A7%84%E5%88%99%E8%BF%87%E6%BB%A4/" title="无标题">无标题</a><time datetime="2025-07-08T15:03:04.854Z" title="发表于 2025-07-08 23:03:04">2025-07-08</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/08/Project/Big-Market/%E8%BF%87%E7%A8%8B%E7%AC%94%E8%AE%B0/7.%20%E6%8A%BD%E5%A5%96%E5%89%8D%E7%BD%AE%E8%A7%84%E5%88%99%E8%BF%87%E6%BB%A4/" title="无标题">无标题</a><time datetime="2025-07-08T15:03:04.853Z" title="发表于 2025-07-08 23:03:04">2025-07-08</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/08/Project/Big-Market/%E8%BF%87%E7%A8%8B%E7%AC%94%E8%AE%B0/6.%20%E6%9D%83%E9%87%8D%E8%A3%85%E9%85%8D%E5%A4%84%E7%90%86/" title="无标题">无标题</a><time datetime="2025-07-08T15:03:04.852Z" title="发表于 2025-07-08 23:03:04">2025-07-08</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/08/Project/Big-Market/%E8%BF%87%E7%A8%8B%E7%AC%94%E8%AE%B0/26.%20%E7%A7%AF%E5%88%86%E9%A2%86%E5%9F%9F%E8%B0%83%E9%A2%9D%E6%9C%8D%E5%8A%A1/" title="无标题">无标题</a><time datetime="2025-07-08T15:03:04.847Z" title="发表于 2025-07-08 23:03:04">2025-07-08</time></div></div></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>分类</span>
            <a class="card-more-btn" href="/categories/" title="查看更多">
      <i class="fas fa-angle-right"></i></a>
          </div>
          <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Java/"><span class="card-category-list-name">Java</span><span class="card-category-list-count">18</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Java/DataBase/"><span class="card-category-list-name">DataBase</span><span class="card-category-list-count">1</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Java/DataBase/MyBatis/"><span class="card-category-list-name">MyBatis</span><span class="card-category-list-count">1</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Java/Java%E8%BF%9B%E9%98%B6/"><span class="card-category-list-name">Java进阶</span><span class="card-category-list-count">11</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Java/Java%E8%BF%9B%E9%98%B6/JUC%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/"><span class="card-category-list-name">JUC并发编程</span><span class="card-category-list-count">3</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Java/Java%E8%BF%9B%E9%98%B6/JVM/"><span class="card-category-list-name">JVM</span><span class="card-category-list-count">5</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Java/Java%E8%BF%9B%E9%98%B6/Java%E9%9B%86%E5%90%88%E6%A1%86%E6%9E%B6/"><span class="card-category-list-name">Java集合框架</span><span class="card-category-list-count">2</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Java/Java%E8%BF%9B%E9%98%B6/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"><span class="card-category-list-name">基础知识</span><span class="card-category-list-count">1</span></a></li></ul></li></ul></li>
          </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/tags/happens-before/" style="font-size: 1.1em; color: #999">happens-before</a> <a href="/tags/DDD/" style="font-size: 1.5em; color: #99a9bf">DDD</a> <a href="/tags/%E8%BF%90%E8%A1%8C%E6%97%B6%E6%95%B0%E6%8D%AE%E5%8C%BA/" style="font-size: 1.1em; color: #999">运行时数据区</a> <a href="/tags/%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF/" style="font-size: 1.1em; color: #999">应用场景</a> <a href="/tags/%E8%99%9A%E6%8B%9F%E5%86%85%E5%AD%98/" style="font-size: 1.1em; color: #999">虚拟内存</a> <a href="/tags/RequestMapping/" style="font-size: 1.1em; color: #999">RequestMapping</a> <a href="/tags/Deployment/" style="font-size: 1.1em; color: #999">Deployment</a> <a href="/tags/JDBC/" style="font-size: 1.5em; color: #99a9bf">JDBC</a> <a href="/tags/SpringBoot/" style="font-size: 1.5em; color: #99a9bf">SpringBoot</a> <a href="/tags/Starter/" style="font-size: 1.1em; color: #999">Starter</a> <a href="/tags/%E7%8A%B6%E6%80%81%E7%A0%81/" style="font-size: 1.1em; color: #999">状态码</a> <a href="/tags/%E5%8A%A8%E6%80%81SQL/" style="font-size: 1.1em; color: #999">动态SQL</a> <a href="/tags/CSS/" style="font-size: 1.1em; color: #999">CSS</a> <a href="/tags/%E7%B4%A2%E5%BC%95/" style="font-size: 1.1em; color: #999">索引</a> <a href="/tags/%E5%8F%AF%E9%9D%A0%E4%BC%A0%E8%BE%93/" style="font-size: 1.1em; color: #999">可靠传输</a> <a href="/tags/%E5%8C%85%E8%A3%85%E7%B1%BB/" style="font-size: 1.1em; color: #999">包装类</a> <a href="/tags/%E5%88%A0%E9%99%A4%E7%AD%96%E7%95%A5/" style="font-size: 1.1em; color: #999">删除策略</a> <a href="/tags/JDK/" style="font-size: 1.1em; color: #999">JDK</a> <a href="/tags/%E7%BC%93%E5%AD%98%E6%9C%BA%E5%88%B6/" style="font-size: 1.1em; color: #999">缓存机制</a> <a href="/tags/Java%E5%9F%BA%E7%A1%80/" style="font-size: 1.1em; color: #999">Java基础</a> <a href="/tags/%E5%90%8C%E6%AD%A5%E9%94%81/" style="font-size: 1.1em; color: #999">同步锁</a> <a href="/tags/%E8%BD%BB%E9%87%8F%E7%BA%A7%E9%94%81/" style="font-size: 1.1em; color: #999">轻量级锁</a> <a href="/tags/%E5%B9%B6%E5%8F%91/" style="font-size: 1.1em; color: #999">并发</a> <a href="/tags/JS/" style="font-size: 1.5em; color: #99a9bf">JS</a> <a href="/tags/Bean%E8%A3%85%E9%85%8D/" style="font-size: 1.1em; color: #999">Bean装配</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C/" style="font-size: 1.1em; color: #999">数据库操作</a> <a href="/tags/Hash/" style="font-size: 1.1em; color: #999">Hash</a> <a href="/tags/%E8%AE%BF%E9%97%AE%E6%A0%87%E5%BF%97/" style="font-size: 1.1em; color: #999">访问标志</a> <a href="/tags/%E8%B4%AB%E8%A1%80%E6%A8%A1%E5%9E%8B/" style="font-size: 1.1em; color: #999">贫血模型</a> <a href="/tags/AOF/" style="font-size: 1.5em; color: #99a9bf">AOF</a> <a href="/tags/CGLIB%E4%BB%A3%E7%90%86/" style="font-size: 1.1em; color: #999">CGLIB代理</a> <a href="/tags/%E4%B8%8A%E4%B8%8B%E6%96%87%E5%88%87%E6%8D%A2/" style="font-size: 1.1em; color: #999">上下文切换</a> <a href="/tags/%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86/" style="font-size: 1.1em; color: #999">配置管理</a> <a href="/tags/%E7%BC%93%E5%AD%98/" style="font-size: 1.1em; color: #999">缓存</a> <a href="/tags/%E5%BC%95%E7%94%A8%E8%AE%A1%E6%95%B0/" style="font-size: 1.1em; color: #999">引用计数</a> <a href="/tags/%E6%B5%81%E5%BC%8F%E5%AF%B9%E8%AF%9D/" style="font-size: 1.1em; color: #999">流式对话</a> <a href="/tags/Spring/" style="font-size: 1.5em; color: #99a9bf">Spring</a> <a href="/tags/%E5%8F%AF%E8%A7%81%E6%80%A7/" style="font-size: 1.5em; color: #99a9bf">可见性</a> <a href="/tags/%E8%BF%9B%E7%A8%8B%E7%8A%B6%E6%80%81/" style="font-size: 1.1em; color: #999">进程状态</a> <a href="/tags/%E7%BC%93%E5%AD%98%E4%B8%80%E8%87%B4%E6%80%A7/" style="font-size: 1.1em; color: #999">缓存一致性</a></div></div><div class="card-widget card-archives">
    <div class="item-headline">
      <i class="fas fa-archive"></i>
      <span>归档</span>
      
    </div>
  
    <ul class="card-archive-list">
      
        <li class="card-archive-list-item">
          <a class="card-archive-list-link" href="/archives/2025/07/">
            <span class="card-archive-list-date">
              七月 2025
            </span>
            <span class="card-archive-list-count">131</span>
          </a>
        </li>
      
    </ul>
  </div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站信息</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">131</div></div><div class="webinfo-item"><div class="item-name">本站总字数 :</div><div class="item-count">236.8k</div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2025-07-09T13:48:16.773Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(https://raw.githubusercontent.com/fang-tech/Pic/main/img/psc.jpg);"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;2025 By Func</span><span class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.4.1</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="translateLink" type="button" title="简繁转换">简</button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><div class="js-pjax"><script>window.typedJSFn = {
  init: str => {
    window.typed = new Typed('#subtitle', Object.assign({
      strings: str,
      startDelay: 300,
      typeSpeed: 150,
      loop: true,
      backSpeed: 50,
    }, null))
  },
  run: subtitleType => {
    if (true) {
      if (typeof Typed === 'function') {
        subtitleType()
      } else {
        btf.getScript('https://cdn.jsdelivr.net/npm/typed.js/dist/typed.umd.min.js').then(subtitleType)
      }
    } else {
      subtitleType()
    }
  },
  processSubtitle: (content, extraContents = []) => {
    if (true) {
      const sub = ["走暗路，耕瘦田，进窄门"].slice()

      if (extraContents.length > 0) {
        sub.unshift(...extraContents)
      }

      if (typeof content === 'string') {
        sub.unshift(content)
      } else if (Array.isArray(content)) {
        sub.unshift(...content)
      }

      sub.length > 0 && typedJSFn.init(sub)
    } else {
      document.getElementById('subtitle').textContent = typeof content === 'string' ? content :
        (Array.isArray(content) && content.length > 0 ? content[0] : '')
    }
  }
}
btf.addGlobalFn('pjaxSendOnce', () => { typed.destroy() }, 'typedDestroy')
</script><script>function subtitleType () {
  typedJSFn.processSubtitle(["走暗路，耕瘦田，进窄门"])
}
typedJSFn.run(subtitleType)</script></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>