<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Spring框架核心概念详解 | 走难</title><meta name="author" content="Func"><meta name="copyright" content="Func"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="2. IoC注入2.1 set注入 在代码中, 创建setXxx的方法 在需要创建依赖的Bean里创建Property属性, 添加name和ref name填入xxx(set方法后面的单词的首字母小写结果) ref 填入需要注入的实际的bean的id, 这里的注入, 可以理解为一种向set方法里传参    2.2 构造注入 是在创建对象的时候注入, 和set注入的时机不一样 需要有参构造方法  2">
<meta property="og:type" content="article">
<meta property="og:title" content="Spring框架核心概念详解">
<meta property="og:url" content="https://fang-tech.github.io/2025/07/08/Java/Spring/Spring_/Spring/index.html">
<meta property="og:site_name" content="走难">
<meta property="og:description" content="2. IoC注入2.1 set注入 在代码中, 创建setXxx的方法 在需要创建依赖的Bean里创建Property属性, 添加name和ref name填入xxx(set方法后面的单词的首字母小写结果) ref 填入需要注入的实际的bean的id, 这里的注入, 可以理解为一种向set方法里传参    2.2 构造注入 是在创建对象的时候注入, 和set注入的时机不一样 需要有参构造方法  2">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://raw.githubusercontent.com/fang-tech/Pic/main/img/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20250709003827.jpg">
<meta property="article:published_time" content="2025-07-07T16:00:00.000Z">
<meta property="article:modified_time" content="2025-07-08T15:25:05.374Z">
<meta property="article:author" content="Func">
<meta property="article:tag" content="Spring">
<meta property="article:tag" content="IoC">
<meta property="article:tag" content="DI">
<meta property="article:tag" content="AOP">
<meta property="article:tag" content="Bean管理">
<meta property="article:tag" content="依赖注入">
<meta property="article:tag" content="面向切面编程">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/fang-tech/Pic/main/img/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20250709003827.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Spring框架核心概念详解",
  "url": "https://fang-tech.github.io/2025/07/08/Java/Spring/Spring_/Spring/",
  "image": "https://raw.githubusercontent.com/fang-tech/Pic/main/img/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20250709003827.jpg",
  "datePublished": "2025-07-07T16:00:00.000Z",
  "dateModified": "2025-07-08T15:25:05.374Z",
  "author": [
    {
      "@type": "Person",
      "name": "Func",
      "url": "https://fang-tech.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="https://raw.githubusercontent.com/fang-tech/Pic/main/img/pngtree-round-logo-with-mountains-and-water-vector-png-image_7031662.png"><link rel="canonical" href="https://fang-tech.github.io/2025/07/08/Java/Spring/Spring_/Spring/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          const mediaQueryDark = window.matchMedia('(prefers-color-scheme: dark)')
          const mediaQueryLight = window.matchMedia('(prefers-color-scheme: light)')

          if (theme === undefined) {
            if (mediaQueryLight.matches) activateLightMode()
            else if (mediaQueryDark.matches) activateDarkMode()
            else {
              const hour = new Date().getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            mediaQueryDark.addEventListener('change', () => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else {
            theme === 'light' ? activateLightMode() : activateDarkMode()
          }
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.json","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Spring框架核心概念详解',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="https://raw.githubusercontent.com/fang-tech/Pic/main/img/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20250709003827.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">131</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">271</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">48</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/java/"><i class="fa-fw fas fa-music"></i><span> Java</span></a></li><li><a class="site-page child" href="/Spring/"><i class="fa-fw fas fa-video"></i><span> Spring</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://raw.githubusercontent.com/fang-tech/Pic/main/img/psc.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">走难</span></a><a class="nav-page-title" href="/"><span class="site-name">Spring框架核心概念详解</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/java/"><i class="fa-fw fas fa-music"></i><span> Java</span></a></li><li><a class="site-page child" href="/Spring/"><i class="fa-fw fas fa-video"></i><span> Spring</span></a></li></ul></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Spring框架核心概念详解</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-07-07T16:00:00.000Z" title="发表于 2025-07-08 00:00:00">2025-07-08</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-07-08T15:25:05.374Z" title="更新于 2025-07-08 23:25:05">2025-07-08</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Java/">Java</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Java/Spring/">Spring</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Java/Spring/%E6%A1%86%E6%9E%B6%E5%9F%BA%E7%A1%80/">框架基础</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">9.8k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>43分钟</span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h2 id="2-IoC注入"><a href="#2-IoC注入" class="headerlink" title="2. IoC注入"></a>2. IoC注入</h2><h3 id="2-1-set注入"><a href="#2-1-set注入" class="headerlink" title="2.1 set注入"></a>2.1 set注入</h3><ul>
<li>在代码中, 创建setXxx的方法</li>
<li>在需要创建依赖的Bean里创建Property属性, 添加name和ref<ul>
<li>name填入xxx(set方法后面的单词的首字母小写结果)</li>
<li>ref 填入需要注入的实际的bean的id, 这里的注入, 可以理解为一种向set方法里传参</li>
</ul>
</li>
</ul>
<h3 id="2-2-构造注入"><a href="#2-2-构造注入" class="headerlink" title="2.2 构造注入"></a>2.2 构造注入</h3><ul>
<li>是在创建对象的时候注入, 和set注入的时机不一样</li>
<li>需要有参构造方法</li>
</ul>
<h3 id="2-3-注入过程说明"><a href="#2-3-注入过程说明" class="headerlink" title="2.3 注入过程说明"></a>2.3 注入过程说明</h3><blockquote>
<p>设置依赖注入的过程</p>
</blockquote>
<ol>
<li>编写xml文件, 在其中添加bean, 并设置id与绑定class</li>
<li>向对应的bean中注入数据</li>
<li>在主程序中获取</li>
</ol>
<blockquote>
<p>xml文件</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.func.spring.dao.UserDao&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;vipDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.func.spring.dao.VipDao&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--构造注入--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--参数名和索引均不指定, 让spring自己做类型匹配--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;csbean3&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.func.spring.service.CustomService&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">ref</span>=<span class="string">&quot;userDao&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">ref</span>=<span class="string">&quot;vipDao&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--根据构造方法的参数名字注入--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;csbean2&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.func.spring.service.CustomService&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;userDao&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;vipDao&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;vipDao&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--根据索引注入--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--ref填入的是ben的id--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;customService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.func.spring.service.CustomService&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">&quot;0&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;userDao&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">&quot;1&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;vipDao&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>java文件</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testConstructor</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;beans.xml&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">CustomService</span> <span class="variable">customService</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;customService&quot;</span>, CustomService.class);</span><br><span class="line">    customService.save();</span><br><span class="line"></span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;beans.xml&quot;</span>);</span><br><span class="line">    <span class="type">CustomService</span> <span class="variable">customService1</span> <span class="operator">=</span> applicationContext1.getBean(<span class="string">&quot;csbean2&quot;</span>, CustomService.class);</span><br><span class="line">    customService1.save();</span><br><span class="line"></span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;beans.xml&quot;</span>);</span><br><span class="line">    <span class="type">CustomService</span> <span class="variable">customService2</span> <span class="operator">=</span> applicationContext2.getBean(<span class="string">&quot;csbean3&quot;</span>, CustomService.class);</span><br><span class="line">    customService2.save();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-4-set注入专题"><a href="#2-4-set注入专题" class="headerlink" title="2.4 set注入专题"></a>2.4 set注入专题</h3><h4 id="2-4-1-内部bean和外部bean"><a href="#2-4-1-内部bean和外部bean" class="headerlink" title="2.4.1 内部bean和外部bean"></a>2.4.1 内部bean和外部bean</h4><ul>
<li><p>通过在外部新建一个bean, 然后另一个bean通过设置ref属性的引入方式称为外部引入</p>
</li>
<li><p>通过在该bean中嵌套另一个bean的方式称为内部bean</p>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--外部bean, 通过ref引用--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;oderDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.func.spring.dao.OderDao&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;oderServ1&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.func.spring.service.OderService&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;oderDao&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;oderDao&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--内部bean, 通过嵌套生成--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;oderServ2&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.func.spring.service.OderService&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;oderDao&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.func.spring.dao.OderDao&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="2-4-2-注入简单类型"><a href="#2-4-2-注入简单类型" class="headerlink" title="2.4.2 注入简单类型"></a>2.4.2 注入简单类型</h4><blockquote>
<p>有哪些属于简单类型</p>
</blockquote>
<ul>
<li>Spring源码中对简单类型的界定</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BeanUtils</span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//.......</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * Check if the given type represents a &quot;simple&quot; property: a simple value</span></span><br><span class="line"><span class="comment">	 * type or an array of simple value types.</span></span><br><span class="line"><span class="comment">	 * &lt;p&gt;See &#123;<span class="doctag">@link</span> #isSimpleValueType(Class)&#125; for the definition of &lt;em&gt;simple</span></span><br><span class="line"><span class="comment">	 * value type&lt;/em&gt;.</span></span><br><span class="line"><span class="comment">	 * &lt;p&gt;Used to determine properties to check for a &quot;simple&quot; dependency-check.</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> type the type to check</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span> whether the given type represents a &quot;simple&quot; property</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@see</span> org.springframework.beans.factory.support.RootBeanDefinition#DEPENDENCY_CHECK_SIMPLE</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@see</span> org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory#checkDependencies</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@see</span> #isSimpleValueType(Class)</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">isSimpleProperty</span><span class="params">(Class&lt;?&gt; type)</span> &#123;</span><br><span class="line">		Assert.notNull(type, <span class="string">&quot;&#x27;type&#x27; must not be null&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span> isSimpleValueType(type) || (type.isArray() &amp;&amp; isSimpleValueType(type.getComponentType()));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * Check if the given type represents a &quot;simple&quot; value type: a primitive or</span></span><br><span class="line"><span class="comment">	 * primitive wrapper, an enum, a String or other CharSequence, a Number, a</span></span><br><span class="line"><span class="comment">	 * Date, a Temporal, a URI, a URL, a Locale, or a Class.</span></span><br><span class="line"><span class="comment">	 * &lt;p&gt;&#123;<span class="doctag">@code</span> Void&#125; and &#123;<span class="doctag">@code</span> void&#125; are not considered simple value types.</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> type the type to check</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span> whether the given type represents a &quot;simple&quot; value type</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@see</span> #isSimpleProperty(Class)</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">isSimpleValueType</span><span class="params">(Class&lt;?&gt; type)</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> (Void.class != type &amp;&amp; <span class="keyword">void</span>.class != type &amp;&amp;</span><br><span class="line">				(ClassUtils.isPrimitiveOrWrapper(type) ||</span><br><span class="line">				Enum.class.isAssignableFrom(type) ||</span><br><span class="line">				CharSequence.class.isAssignableFrom(type) ||</span><br><span class="line">				Number.class.isAssignableFrom(type) ||</span><br><span class="line">				Date.class.isAssignableFrom(type) ||</span><br><span class="line">				Temporal.class.isAssignableFrom(type) ||</span><br><span class="line">				URI.class == type ||</span><br><span class="line">				URL.class == type ||</span><br><span class="line">				Locale.class == type ||</span><br><span class="line">				Class.class == type));</span><br><span class="line">	&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//........</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>通过源码分析得知，简单类型包括：</strong></p>
<ul>
<li><strong>基本数据类型</strong></li>
<li><strong>基本数据类型对应的包装类</strong></li>
<li><strong>String或其他的CharSequence子类</strong></li>
<li><strong>Number子类</strong></li>
<li><strong>Date子类</strong></li>
<li><strong>Enum子类</strong></li>
<li><strong>URI</strong></li>
<li><strong>URL</strong></li>
<li><strong>Temporal子类</strong></li>
<li><strong>Locale</strong></li>
<li><strong>Class</strong></li>
<li><strong>另外还包括以上简单值类型对应的数组类型。</strong></li>
</ul>
<blockquote>
<p>给简单类型注入, 使用value属性赋值, 而不是ref, ref给对象属性赋值, 需要特别注意的是简单类型中的Date类型</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;spv&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.func.spring.bean.SimpleValue&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;i1&quot;</span> <span class="attr">value</span>=<span class="string">&quot;213&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;i2&quot;</span> <span class="attr">value</span>=<span class="string">&quot;123&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;b1&quot;</span> <span class="attr">value</span>=<span class="string">&quot;false&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;b2&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;c1&quot;</span> <span class="attr">value</span>=<span class="string">&quot;c&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;c2&quot;</span> <span class="attr">value</span>=<span class="string">&quot;d&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;string&quot;</span> <span class="attr">value</span>=<span class="string">&quot;fung&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;season&quot;</span> <span class="attr">value</span>=<span class="string">&quot;SPRING&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;clazz&quot;</span> <span class="attr">value</span>=<span class="string">&quot;java.lang.String&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--如果要把Data当成简单类型, 输入需要满足特定的格式--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--value后面的日期字符串格式不能随便写，必须是Date对象toString()方法执行的结果--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--实际开发中, 一般不会将Data当成简单类型--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;property name=&quot;birth&quot; value=&quot;Fri Sep 30 15:26:38 CST 2022&quot;/&gt;--&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="2-4-3-简单类型的注入的经典应用"><a href="#2-4-3-简单类型的注入的经典应用" class="headerlink" title="2.4.3 简单类型的注入的经典应用"></a>2.4.3 简单类型的注入的经典应用</h4><blockquote>
<p>用于配置配置文件</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.func.spring.jdbc.MyDataSource&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;jdbc:mysql://localhost:3360/spring6&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="2-4-4-注入数组"><a href="#2-4-4-注入数组" class="headerlink" title="2.4.4 注入数组"></a>2.4.4 注入数组</h4><blockquote>
<p>在&lt;property&gt;下再添加一组&lt;array&gt;标签即可 , 然后在里面添加数据</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;w1&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.func.spring.bean.Woman&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;蔡徐坤&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;w2&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.func.spring.bean.Woman&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;陈立农&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;w3&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.func.spring.bean.Woman&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;及格&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;qian&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.func.spring.bean.YuQian&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;habits&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>抽烟<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>喝酒<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>烫头<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;women&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ref</span> <span class="attr">bean</span>=<span class="string">&quot;w1&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ref</span> <span class="attr">bean</span>=<span class="string">&quot;w2&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ref</span> <span class="attr">bean</span>=<span class="string">&quot;w3&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="2-4-5-Set集合-Map集合-Properties类型注入"><a href="#2-4-5-Set集合-Map集合-Properties类型注入" class="headerlink" title="2.4.5 Set集合, Map集合, Properties类型注入"></a>2.4.5 Set集合, Map集合, Properties类型注入</h4><blockquote>
<p>Set</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--测试Set--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;addr&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>ff<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>ff<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>df<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>ff<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>Map</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--测试Map--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;phones&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">map</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;1&quot;</span> <span class="attr">value</span>=<span class="string">&quot;110&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;2&quot;</span> <span class="attr">value</span>=<span class="string">&quot;120&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;3&quot;</span> <span class="attr">value</span>=<span class="string">&quot;119&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">map</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>Properties</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">    <span class="comment">&lt;!--测试Properties--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;properties&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">props</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;username&quot;</span>&gt;</span>root<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;password&quot;</span>&gt;</span>root<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;url&quot;</span>&gt;</span>jdbc:mysql://localhost:3306:/spring<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;driver&quot;</span>&gt;</span>com.mysql.cj.jdbc.Driver<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">props</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="2-4-6-注入特殊字符与null"><a href="#2-4-6-注入特殊字符与null" class="headerlink" title="2.4.6 注入特殊字符与null"></a>2.4.6 注入特殊字符与null</h4><blockquote>
<p>特殊字符 : 两种方式, 一种是换成转义字符, 还有一种解决方式是使用!&lt;[CDATA[]]&gt;</p>
</blockquote>
<ul>
<li>代码</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;math&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.func.spring.bean.MathBean&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--会报错--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;property name=&quot;data&quot; value=&quot;2 &lt; 3&quot;/&gt;--&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--转义--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;property name=&quot;data&quot; value=&quot;2 &amp;lt; 3&quot;/&gt;--&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--CDATA方式, 其中的value标签需要额外写出来--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;data&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>&lt;![CDATA[2 &lt; 3]]&gt;<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>转移字符表</li>
</ul>
<table>
<thead>
<tr>
<th><strong>特殊字符</strong></th>
<th><strong>转义字符</strong></th>
</tr>
</thead>
<tbody><tr>
<td>&gt;</td>
<td>&amp;gt;</td>
</tr>
<tr>
<td>&lt;</td>
<td>&amp;lt;</td>
</tr>
<tr>
<td>‘</td>
<td>&amp;apos;</td>
</tr>
<tr>
<td>“</td>
<td>&amp;quot;</td>
</tr>
<tr>
<td>&amp;</td>
<td>&amp;amp;</td>
</tr>
</tbody></table>
<blockquote>
<p>注入null与空字符</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;cat&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.func.spring.bean.Cat&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--默认不写的时候, 值就是null--&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--手动设置的方法--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;property name=&quot;name&quot;&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--            &lt;null/&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;/property&gt;--&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--空字符串--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;property name=&quot;name&quot;&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--            &lt;value/&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;/property&gt;--&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>


<h3 id="2-5-基于命名空间的注入和配置复用"><a href="#2-5-基于命名空间的注入和配置复用" class="headerlink" title="2.5 基于命名空间的注入和配置复用"></a>2.5 基于命名空间的注入和配置复用</h3><blockquote>
<p>命名空间的引入, 可以简化配置的过程</p>
</blockquote>
<blockquote>
<p>p命名空间, 能简化set注入的过程</p>
</blockquote>
<ol>
<li>在XML头部信息中添加p命名空间的配置信息：xmlns:p&#x3D;”<a target="_blank" rel="noopener" href="http://www.springframework.org/schema/p%22">http://www.springframework.org/schema/p&quot;</a></li>
<li>提供setter方法</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--p命名空间注入--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dog&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.func.spring.bean.Dog&quot;</span> <span class="attr">p:age</span>=<span class="string">&quot;123&quot;</span> <span class="attr">p:name</span>=<span class="string">&quot;虎牙&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>c命名空间注入, 简化了构造注入的过程</p>
</blockquote>
<ol>
<li>需要在xml配置文件头部添加信息：xmlns:c&#x3D;”<a target="_blank" rel="noopener" href="http://www.springframework.org/schema/c">http://www.springframework.org/schema/c</a>“</li>
<li>需要提供构造方法。</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--c命名空间注入--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dog&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.func.spring.bean.Dog&quot;</span> <span class="attr">c:age</span>=<span class="string">&quot;12&quot;</span> <span class="attr">c:name</span>=<span class="string">&quot;lichengxing&quot;</span> &gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>util命名空间与配置复用 : 通过设置该命名空间能让一份properties被多处引用配置</p>
</blockquote>
<ol>
<li>在xml中进行如下设置<br>![[images&#x2F;Pasted image 20241224140647.png]]</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- util命名空间, 让配置复用--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">util:properties</span> <span class="attr">id</span>=<span class="string">&quot;prop&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;username&quot;</span>&gt;</span>root<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;password&quot;</span>&gt;</span>root<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;url&quot;</span>&gt;</span>jdbc:mysql://localhost:3306/spring<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;driver&quot;</span>&gt;</span>com.mysql.cj.jdbc.Driver<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">util:properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--c命名空间注入--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dog&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.func.spring.bean.Dog&quot;</span> <span class="attr">p:age</span>=<span class="string">&quot;12&quot;</span> <span class="attr">p:name</span>=<span class="string">&quot;lichengxing&quot;</span> &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;properties&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;prop&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dog1&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.func.spring.bean.Dog&quot;</span> <span class="attr">p:age</span>=<span class="string">&quot;2&quot;</span> <span class="attr">p:name</span>=<span class="string">&quot;Lichengxing&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;properties&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;prop&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="2-6-基于XML的自动装配"><a href="#2-6-基于XML的自动装配" class="headerlink" title="2.6 基于XML的自动装配"></a>2.6 基于XML的自动装配</h3><blockquote>
<p>我们可以不用ref来主动设置bean的注入的参数, 通过该功能, XML能够自动出装配参数</p>
</blockquote>
<blockquote>
<p>byName : 通过参数名自动装配, 但这里的参数名实际上是对应的setter方法的名字</p>
</blockquote>
<ul>
<li>设置autowrite属性为byName</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;cs&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.func.spring.service.CustomService&quot;</span> <span class="attr">autowire</span>=<span class="string">&quot;byName&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;vipDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.func.spring.dao.VipDao&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.func.spring.dao.UserDao&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>byType : 通过参数类型自动装配, 通过这种方式, 实例化的bean可以不设置id</p>
</blockquote>
<ul>
<li>设置为byType</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.func.spring.dao.VipDao&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.func.spring.dao.UserDao&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;cs&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.func.spring.service.CustomService&quot;</span> <span class="attr">autowire</span>=<span class="string">&quot;byType&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="2-7-XML装配外部资源文件"><a href="#2-7-XML装配外部资源文件" class="headerlink" title="2.7  XML装配外部资源文件"></a>2.7  XML装配外部资源文件</h3><blockquote>
<p>建立外部资源文件</p>
</blockquote>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">username</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">password</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">url</span>=<span class="string">jdbc:mysql://localhost:3306/spring</span></span><br><span class="line"><span class="attr">driver</span>=<span class="string">com.mysql.cj.jdbc.Driver</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>在bean中引入</p>
</blockquote>
<ol>
<li>修改xml约束, 增加context相关内容</li>
<li>导入外部资源</li>
<li>引用外部资源</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">&quot;jdbc.properties&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;prop&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.func.spring.jdbc.MyDataSource&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;url&#125;&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;driver&#125;&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;username&#125;&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;password&#125;&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="3-Bean的作用域"><a href="#3-Bean的作用域" class="headerlink" title="3. Bean的作用域"></a>3. Bean的作用域</h2><h3 id="3-1-Bean作用域之单例和多例"><a href="#3-1-Bean作用域之单例和多例" class="headerlink" title="3.1 Bean作用域之单例和多例"></a>3.1 Bean作用域之单例和多例</h3><blockquote>
<p>默认情况下</p>
</blockquote>
<ul>
<li>在默认情况下Spring是单例的, 创建实例的时机是在启动容器的时候创建的, 即在new完<code>ClassPathXmlApplicationContext</code>之后即创建完毕, 后面再getBean, 获取到的都是同一个实例</li>
</ul>
<blockquote>
<p>设置为原型&#x2F;多例的情况</p>
</blockquote>
<ul>
<li>通过设置bean的属性scope为prototype, 这个时候创建对象为多例</li>
<li>创建对象的时机时在getbean的时候创建</li>
</ul>
<blockquote>
<p>xml</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;scope&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.func.spring.bean.SpringBean&quot;</span> <span class="attr">scope</span>=<span class="string">&quot;prototype&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>


<h3 id="3-2-自定义scope"><a href="#3-2-自定义scope" class="headerlink" title="3.2 自定义scope"></a>3.2 自定义scope</h3><blockquote>
<p>自定义xml : 这里只是简单提了一下, 这个自定义的scope是直接用的Spring中内置好的类实现的</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;scope&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.func.spring.bean.SpringBean&quot;</span> <span class="attr">scope</span>=<span class="string">&quot;ThreadScope&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.beans.factory.config.CustomScopeConfigurer&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;scopes&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">map</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;ThreadScope&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.context.support.SimpleThreadScope&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">map</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>测试代码</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testThreadScope</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring-bean.xml&quot;</span>);</span><br><span class="line">    <span class="type">SpringBean</span> <span class="variable">scope</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;scope&quot;</span>, SpringBean.class);</span><br><span class="line">    System.out.println(scope);</span><br><span class="line"></span><br><span class="line">    <span class="type">SpringBean</span> <span class="variable">scope1</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;scope&quot;</span>, SpringBean.class);</span><br><span class="line">    System.out.println(scope1);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="keyword">new</span> <span class="title class_">Runnable</span>() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="type">SpringBean</span> <span class="variable">scope2</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;scope&quot;</span>, SpringBean.class);</span><br><span class="line">            System.out.println(scope2);</span><br><span class="line">            <span class="type">SpringBean</span> <span class="variable">scope3</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;scope&quot;</span>, SpringBean.class);</span><br><span class="line">            System.out.println(scope3);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;).start();</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="4-GoF之工厂模式"><a href="#4-GoF之工厂模式" class="headerlink" title="4. GoF之工厂模式"></a>4. GoF之工厂模式</h2><h2 id="5-Bean"><a href="#5-Bean" class="headerlink" title="5. Bean"></a>5. Bean</h2><h3 id="5-1-Bean的四种实例化方法"><a href="#5-1-Bean的四种实例化方法" class="headerlink" title="5.1 Bean的四种实例化方法"></a>5.1 Bean的四种实例化方法</h3><h4 id="5-1-1-通过构造方法的实例化"><a href="#5-1-1-通过构造方法的实例化" class="headerlink" title="5.1.1 通过构造方法的实例化"></a>5.1.1 通过构造方法的实例化</h4><ul>
<li>就是先前创建bean实例的方式, 直接创建对应的bean, 就会通过对应class的无参构造方法实例化对象</li>
</ul>
<h4 id="5-1-2-通过简单工厂模式实例化"><a href="#5-1-2-通过简单工厂模式实例化" class="headerlink" title="5.1.2 通过简单工厂模式实例化"></a>5.1.2 通过简单工厂模式实例化</h4><ul>
<li>步骤<ol>
<li>创建工厂类, 创建产品类</li>
<li>在工厂类中添加简单工厂方法, 用于获取对应的产品</li>
<li>工厂方法需要是public static 类型的, 返回对应产品的新的实例</li>
<li>在xml文件中声明产品类的bean, 设置的class是工厂类, 并添加<code>factory-mothod</code>属性, 填写内容是产品对应工厂方法的名字</li>
</ol>
</li>
</ul>
<blockquote>
<p>最后的对象, 其实是自己new出来的</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StarFactory</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Star <span class="title function_">get</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Star</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Star</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;StarBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.func.spring.StarFactory&quot;</span> <span class="attr">factory-method</span>=<span class="string">&quot;get&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="5-1-3-通过factory-bean实例化"><a href="#5-1-3-通过factory-bean实例化" class="headerlink" title="5.1.3 通过factory-bean实例化"></a>5.1.3 通过factory-bean实例化</h4><blockquote>
<p>通过工厂方法模式实例化 : 每个产品对应一个工厂角色</p>
</blockquote>
<ul>
<li>步骤<ol>
<li>创建对应的产品类和工厂类</li>
<li>创建对应的工厂方法(不是static的, 也因此, 需要指定工厂类)</li>
<li>在xml中声明工厂类bean</li>
<li>通过设置factory-bean为工厂类bean, factory-method为对应的工厂方法, 来实例化新的bean</li>
</ol>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Gun</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GunFactory</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> Gun <span class="title function_">get</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Gun</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;GunFactory&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.func.spring.GunFactory&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;gun&quot;</span> <span class="attr">factory-method</span>=<span class="string">&quot;get&quot;</span> <span class="attr">factory-bean</span>=<span class="string">&quot;GunFactory&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="5-1-4-通过FactoryBean接口实例化"><a href="#5-1-4-通过FactoryBean接口实例化" class="headerlink" title="5.1.4 通过FactoryBean接口实例化"></a>5.1.4 通过FactoryBean接口实例化</h4><blockquote>
<p>实质上是对第三种方法的简化, 通过实现接口来简化第三种方案</p>
</blockquote>
<ul>
<li>步骤<ol>
<li>创建产品类和工厂类</li>
<li>工厂类继承FactoryBean&lt;&gt;接口, 并实现其中的方法</li>
<li>在getObject()中返回new的产品实例</li>
<li>在xml中声明产品bean, 但是其class填写工厂类</li>
</ol>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Person</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;调用了Person的无参构造&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PersonFactory</span> <span class="keyword">implements</span> <span class="title class_">FactoryBean</span>&lt;Person&gt; &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Person <span class="title function_">getObject</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;调用了Person的工厂方法&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Person</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Class&lt;?&gt; getObjectType() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isSingleton</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> FactoryBean.<span class="built_in">super</span>.isSingleton();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;person&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.func.spring.PersonFactory&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="5-1-5-Bean工厂实例化方法的实际运行"><a href="#5-1-5-Bean工厂实例化方法的实际运行" class="headerlink" title="5.1.5 Bean工厂实例化方法的实际运行"></a>5.1.5 Bean工厂实例化方法的实际运行</h4><blockquote>
<p>通过Bean工厂实例化, 来实现对于Date这一属性的赋值</p>
</blockquote>
<ol>
<li>先创建Date工厂</li>
<li>在工厂的getObject方法中, 返回规定了格式的Date对象</li>
<li>返回对应format的Date对象</li>
<li>在xml实例化</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Student</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Date birth;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DateFactory</span> <span class="keyword">implements</span> <span class="title class_">FactoryBean</span>&lt;Date&gt; &#123;</span><br><span class="line">    <span class="keyword">private</span> String strDate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Date <span class="title function_">getObject</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">SimpleDateFormat</span> <span class="variable">sdf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SimpleDateFormat</span>(<span class="string">&quot;yyyy-mm-dd&quot;</span>);</span><br><span class="line">        <span class="type">Date</span> <span class="variable">birth</span> <span class="operator">=</span> sdf.parse(<span class="built_in">this</span>.strDate);</span><br><span class="line">        <span class="keyword">return</span> birth;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Class&lt;?&gt; getObjectType() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.func.spring.DateFactory&quot;</span> <span class="attr">id</span>=<span class="string">&quot;date&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;strDate&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1980-11-20&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;stu&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.func.spring.Student&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;birth&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;date&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="6-Bean的生命周期"><a href="#6-Bean的生命周期" class="headerlink" title="6. Bean的生命周期"></a>6. Bean的生命周期</h2><h3 id="6-1-Bean的生命周期之五步"><a href="#6-1-Bean的生命周期之五步" class="headerlink" title="6.1 Bean的生命周期之五步"></a>6.1 Bean的生命周期之五步</h3><ol>
<li>调用bean的无参构造方法创建bean</li>
<li>为bean赋值</li>
<li>调用bean的init()方法, 初始化bean</li>
<li>使用bean</li>
<li>销毁bean, 调用bean的destroy()方法 : 发生在容器关闭的时候</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">User</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;第一步: 构造bean&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;第二步: 为bean赋值&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">initBean</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;第三步: 初始化bean&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroyBean</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;第五步: 销毁bean&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>容器的关闭需要将ApplicationContest类型强转为ClassPathXmlApplicationContext后才能调用close()方法</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testLifeCycleFive</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;beans.xml&quot;</span>);</span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;user&quot;</span>, User.class);</span><br><span class="line">    System.out.println(<span class="string">&quot;第四步: 使用bean&quot;</span> + user);</span><br><span class="line"></span><br><span class="line">    <span class="type">ClassPathXmlApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> (ClassPathXmlApplicationContext) applicationContext;</span><br><span class="line">    context.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>需要人为创建和绑定初始化和销毁方法</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.func.spring.User&quot;</span> <span class="attr">init-method</span>=<span class="string">&quot;initBean&quot;</span> <span class="attr">destroy-method</span>=<span class="string">&quot;destroyBean&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;张三&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>


<h3 id="6-2-Bean生命周期之七步"><a href="#6-2-Bean生命周期之七步" class="headerlink" title="6.2 Bean生命周期之七步"></a>6.2 Bean生命周期之七步</h3><blockquote>
<p>通过bean后处理器, 在初始化前后添加了两个周期</p>
</blockquote>
<ol>
<li>创建对象实现后处理器接口, 并重写其中的方法</li>
<li>在xml文件中实例化, 这个实现了后处理接口的对象, 这个后处理器的作用范围是整个配置文件</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BeanProcessor</span> <span class="keyword">implements</span> <span class="title class_">BeanPostProcessor</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">postProcessBeforeInitialization</span><span class="params">(Object bean, String beanName)</span> <span class="keyword">throws</span> BeansException &#123;</span><br><span class="line">        System.out.println(beanName + <span class="string">&quot; &quot;</span> + bean + <span class="string">&quot; 在初始化前执行了后处理器中的before方法&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> BeanPostProcessor.<span class="built_in">super</span>.postProcessBeforeInitialization(bean, beanName);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">postProcessAfterInitialization</span><span class="params">(Object bean, String beanName)</span> <span class="keyword">throws</span> BeansException &#123;</span><br><span class="line">        System.out.println(beanName + <span class="string">&quot; &quot;</span> + bean + <span class="string">&quot; 在初始化前执行了后处理器中的after方法&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> BeanPostProcessor.<span class="built_in">super</span>.postProcessAfterInitialization(bean, beanName);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.func.spring.BeanProcessor&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="6-3-Bean的生命周期之十步"><a href="#6-3-Bean的生命周期之十步" class="headerlink" title="6.3 Bean的生命周期之十步"></a>6.3 Bean的生命周期之十步</h3><blockquote>
<p>添加三部分别在</p>
</blockquote>
<ol>
<li>bean后处理器的before方法之前 : 对应的接口有<code>BeanClassLoaderAware, BeanFactoryAware, BeanNameAware</code></li>
<li>bean后处理器的before方法之后 : 对应的接口有<code>InitializingBean</code></li>
<li>bean销毁之前, 即destroy方法调用之前 : 对应的接口有<code>DisposableBean</code></li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> <span class="keyword">implements</span> <span class="title class_">BeanClassLoaderAware</span>, BeanFactoryAware, BeanNameAware, InitializingBean, DisposableBean &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">User</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;第一步: 构造bean&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;第二步: 为bean赋值&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">initBean</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;第三步: 初始化bean&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroyBean</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;第五步: 销毁bean&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setBeanClassLoader</span><span class="params">(ClassLoader classLoader)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Bean的类加载器是&quot;</span> + classLoader);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setBeanFactory</span><span class="params">(BeanFactory beanFactory)</span> <span class="keyword">throws</span> BeansException &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;生产bean的工厂是&quot;</span> + beanFactory);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setBeanName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;bean的名字是&quot;</span> + name);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterPropertiesSet</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;执行了 afterPropertiesSet() 方法&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;执行了销毁bean前的会执行的方法&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="6-4-生命周期之不同作用域"><a href="#6-4-生命周期之不同作用域" class="headerlink" title="6.4 生命周期之不同作用域"></a>6.4 生命周期之不同作用域</h3><ul>
<li>只有单例的bean实例, Spring才会全程管理</li>
<li>如果是多例的bean. Spring只会管理到使用bean那一步, 后续的两步DisposableBean接口对应的Destroy方法和bean实例的销毁方法都不会再由Spring管理</li>
</ul>
<h3 id="6-5-如何让自己new的对象给Spring管理"><a href="#6-5-如何让自己new的对象给Spring管理" class="headerlink" title="6.5 如何让自己new的对象给Spring管理"></a>6.5 如何让自己new的对象给Spring管理</h3><blockquote>
<p>如何在半途中将自己new的对象交给Spring管理</p>
</blockquote>
<ol>
<li>new一个自己的对象</li>
<li>通过DefaultListableBeanFactory类, 注册单例, 并通过这个类从容器中获取bean</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testRegisterBean</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">    System.out.println(user);</span><br><span class="line"></span><br><span class="line">    <span class="type">DefaultListableBeanFactory</span> <span class="variable">factory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DefaultListableBeanFactory</span>();</span><br><span class="line">    factory.registerSingleton(<span class="string">&quot;userBean&quot;</span>,user);</span><br><span class="line">    <span class="type">User</span> <span class="variable">user1</span> <span class="operator">=</span> factory.getBean(<span class="string">&quot;userBean&quot;</span>, User.class);</span><br><span class="line">    System.out.println(user1);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="7-Bean的循环依赖"><a href="#7-Bean的循环依赖" class="headerlink" title="7. Bean的循环依赖"></a>7. Bean的循环依赖</h2><blockquote>
<p>什么情况是循环依赖</p>
</blockquote>
<ul>
<li>当对象A中有属性B, 同时对象B中也有属性A, 那么这个在通过Spring实例化的时候, 就出现了循环依赖</li>
</ul>
<h4 id="7-1-通过setter实例化的bean对象"><a href="#7-1-通过setter实例化的bean对象" class="headerlink" title="7.1 通过setter实例化的bean对象"></a>7.1 通过setter实例化的bean对象</h4><ul>
<li>只有Setter + singleton的组合, 才能即使产生了循环依赖, 但是也能成功实例化</li>
</ul>
<blockquote>
<p>为什么这个组合能成功, 但是prototype却会创建失败</p>
</blockquote>
<ul>
<li>Spring在创建单例的实例的过程中采取先”曝光”, 后赋值的形式, 这对于Spring来说是两个阶段</li>
<li>Spring会在第一个阶段将所有的单例的bean先通过无参构造方法创建好, 再进行曝光</li>
<li>在第二个阶段再进行赋值操作, 这样在赋值的时候, 就能成功的将创建好的对象传入</li>
<li>同时, 根据上面的原理, 我们可以知道, 相互依赖的两个对象, 其实只要有一个对象是单例的, 就能成功实例化</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Husband</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Wife wife;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Husband&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, wife=&quot;</span> + wife.getName() +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Wife</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Husband husband;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring1.xml&quot;</span>);</span><br><span class="line">        <span class="type">Husband</span> <span class="variable">husband</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;husband&quot;</span>, Husband.class);</span><br><span class="line">        System.out.println(husband);</span><br></pre></td></tr></table></figure>

<h3 id="7-2-通过有参构造器实例化bean对象"><a href="#7-2-通过有参构造器实例化bean对象" class="headerlink" title="7.2 通过有参构造器实例化bean对象"></a>7.2 通过有参构造器实例化bean对象</h3><blockquote>
<p>根据上面的原理, 其实能得出, 如果是通过有参构造器实例化bean对象, 那么怎么样都是不能够成功创建的</p>
</blockquote>
<h3 id="7-3-Bean的循环依赖之源码分析"><a href="#7-3-Bean的循环依赖之源码分析" class="headerlink" title="7.3 Bean的循环依赖之源码分析"></a>7.3 Bean的循环依赖之源码分析</h3><blockquote>
<p>通过分析Spring源码, 能得出Spring通过三级缓存完成了提前曝光的过程</p>
</blockquote>
<ul>
<li>一级缓存 : 缓存的是完整的单例Bean对象, 已经完成了赋值</li>
<li>二级缓存 : 缓存的是没有进行赋值的单例Bean对象</li>
<li>三级缓存 : 缓存的是单例Bean对象的工厂对象, 这个对象也是被提前曝光的对象</li>
<li>Spring在getSingleton()方法中, 从第一级逐级访问来查看该层缓存有没有保存对应的bean对象</li>
</ul>
<h2 id="8-回顾反射机制"><a href="#8-回顾反射机制" class="headerlink" title="8.回顾反射机制"></a>8.回顾反射机制</h2><p>[[javaAdvance#44. 反射]]</p>
<h2 id="9-手写spring框架"><a href="#9-手写spring框架" class="headerlink" title="9. 手写spring框架"></a>9. 手写spring框架</h2><h3 id="9-1-创建相关类"><a href="#9-1-创建相关类" class="headerlink" title="9.1 创建相关类"></a>9.1 创建相关类</h3><ol>
<li>创建ApplicationContext接口, 并在其中添加<code>getBean(String beanId)</code>方法</li>
<li>创建实现类</li>
</ol>
<h3 id="9-2-创建bean实例并存储到map中"><a href="#9-2-创建bean实例并存储到map中" class="headerlink" title="9.2 创建bean实例并存储到map中"></a>9.2 创建bean实例并存储到map中</h3><ol>
<li>创建map集合用于存储beans</li>
<li>解析xml文件, 并将解析获取到的类调用无参构造方法后实例化到beanMap中<ol>
<li>使用SAXReader.read从Resource文件夹中获取resourse路径对应的xml文件的文本流</li>
<li>利用第一步获取到的document对象, 从中获取到根标签, 并从中获取到所有一级子标签List -&gt; beanNodes</li>
<li>从一级子标签获取id和class属性, 通过class属性填写的类路径实例化bean, 并以id为名字存入beanMap中</li>
</ol>
</li>
<li>以此完成了一级存储和曝光</li>
</ol>
<h3 id="9-3-给bean的属性赋值"><a href="#9-3-给bean的属性赋值" class="headerlink" title="9.3 给bean的属性赋值"></a>9.3 给bean的属性赋值</h3><ol>
<li>遍历beanNodes</li>
<li>获取id属性, 以对应beanMap中的实例, 获取所有的property子标签properties, 以完成赋值</li>
<li>通过properties获取属性name和value(或ref)</li>
<li>通过name, 拼接出set方法的方法名</li>
<li>通过反射获取到set方法</li>
<li>调用set方法赋值, 通过属性是value还是ref, 判断是简单类型还是引用类型<ol>
<li>是简单类型<ol>
<li>获取到类中对应name的field的类型</li>
<li>通过switch case语句, 完成对value的类型转换</li>
<li>调用set方法将值注入</li>
</ol>
</li>
<li>非简单类型<ol>
<li>直接从beanMap中通过ref的名字获取到对应对象的引用</li>
<li>调用set方法将值注入</li>
</ol>
</li>
</ol>
</li>
</ol>
<h3 id="9-4-完整源码"><a href="#9-4-完整源码" class="headerlink" title="9.4 完整源码"></a>9.4 完整源码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> 方天宇</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@className</span> ClassPathXmlApplicationContext</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2024/12/26</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ClassPathXmlApplicationContext</span> <span class="keyword">implements</span> <span class="title class_">ApplicationContext</span> &#123;</span><br><span class="line">    <span class="comment">// Map用于存储bean</span></span><br><span class="line">    <span class="keyword">private</span> Map&lt;String, Object&gt; beanMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 构造方法解析xml文件, 并创建所有的实例bean, 以此实现曝光</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> resource xml文件的资源路径</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ClassPathXmlApplicationContext</span><span class="params">(String resource)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">SAXReader</span> <span class="variable">saxReader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SAXReader</span>();</span><br><span class="line">            <span class="type">Document</span> <span class="variable">document</span> <span class="operator">=</span> saxReader.read(ClassLoader.getSystemClassLoader().getResourceAsStream(resource));</span><br><span class="line">            <span class="comment">// 获取到所有的bean标签</span></span><br><span class="line">            List&lt;Element&gt; beanNodes = document.getRootElement().elements();</span><br><span class="line">            <span class="comment">// 遍历标签</span></span><br><span class="line">            beanNodes.forEach(beanNode -&gt; &#123;</span><br><span class="line">                <span class="type">String</span> <span class="variable">id</span> <span class="operator">=</span> beanNode.attributeValue(<span class="string">&quot;id&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">className</span> <span class="operator">=</span> beanNode.attributeValue(<span class="string">&quot;class&quot;</span>);</span><br><span class="line"></span><br><span class="line">                <span class="comment">// 通过反射机制创建对象, 并放入map集合中</span></span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    Class&lt;?&gt; clazz = Class.forName(className);</span><br><span class="line">                    <span class="comment">// 创建新的实例</span></span><br><span class="line">                    Constructor&lt;?&gt; constructor = clazz.getConstructor();</span><br><span class="line">                    Object bean= constructor.newInstance();</span><br><span class="line">                    <span class="comment">// 将新的实例添加到Map集合中</span></span><br><span class="line">                    beanMap.put(id, bean);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        <span class="comment">// 给bean的属性赋值, 将创建对象和赋值这两阶段分开进行, 以此实现曝光</span></span><br><span class="line">        beanNodes.forEach(beanNode -&gt;&#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">id</span> <span class="operator">=</span> beanNode.attributeValue(<span class="string">&quot;id&quot;</span>);</span><br><span class="line">            List&lt;Element&gt; properties = beanNode.elements(<span class="string">&quot;property&quot;</span>);</span><br><span class="line">            properties.forEach(property -&gt; &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="type">String</span> <span class="variable">propertyName</span> <span class="operator">=</span> property.attributeValue(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">                    <span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> property.attributeValue(<span class="string">&quot;value&quot;</span>);</span><br><span class="line">                    <span class="type">String</span> <span class="variable">ref</span> <span class="operator">=</span> property.attributeValue(<span class="string">&quot;ref&quot;</span>);</span><br><span class="line">                    <span class="comment">// 获取属性类型</span></span><br><span class="line">                    Class&lt;?&gt; propertyType = beanMap.get(id).getClass().getDeclaredField(propertyName).getType();</span><br><span class="line">                    <span class="comment">// 获取set方法</span></span><br><span class="line">                    <span class="type">String</span> <span class="variable">setMethodName</span> <span class="operator">=</span> <span class="string">&quot;set&quot;</span> + propertyName.toUpperCase().charAt(<span class="number">0</span>) + propertyName.substring(<span class="number">1</span>);</span><br><span class="line">                    <span class="type">Method</span> <span class="variable">setMethod</span> <span class="operator">=</span> beanMap.get(id).getClass().getDeclaredMethod(setMethodName, propertyType);</span><br><span class="line">                    <span class="comment">// 获取set方法</span></span><br><span class="line">                    <span class="type">Object</span> <span class="variable">propertyValue</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">                    <span class="keyword">if</span> (value == <span class="literal">null</span>) &#123;</span><br><span class="line">                        <span class="comment">// 非简单类型</span></span><br><span class="line">                        setMethod.invoke(beanMap.get(id), beanMap.get(ref));</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span> (ref == <span class="literal">null</span>) &#123;</span><br><span class="line">                        <span class="comment">// 简单类型</span></span><br><span class="line">                        <span class="type">String</span> <span class="variable">propertySimpleName</span> <span class="operator">=</span> propertyType.getSimpleName();</span><br><span class="line">                        <span class="comment">// 将值从String转为对应的简单类型</span></span><br><span class="line">                        <span class="keyword">switch</span> (propertySimpleName) &#123;</span><br><span class="line">                            <span class="keyword">case</span> <span class="string">&quot;int&quot;</span> : <span class="keyword">case</span> <span class="string">&quot;Integer&quot;</span> :</span><br><span class="line">                                propertyValue = Integer.valueOf(value);</span><br><span class="line">                                <span class="keyword">break</span>;</span><br><span class="line">                            <span class="keyword">case</span> <span class="string">&quot;double&quot;</span> : <span class="keyword">case</span> <span class="string">&quot;Double&quot;</span>:</span><br><span class="line">                                propertyValue = Double.valueOf(value);</span><br><span class="line">                                <span class="keyword">break</span>;</span><br><span class="line">                            <span class="keyword">case</span> <span class="string">&quot;float&quot;</span>: <span class="keyword">case</span> <span class="string">&quot;Float&quot;</span>:</span><br><span class="line">                                propertyValue = Float.valueOf(value);</span><br><span class="line">                                <span class="keyword">break</span>;</span><br><span class="line">                            <span class="keyword">case</span> <span class="string">&quot;long&quot;</span> : <span class="keyword">case</span> <span class="string">&quot;Long&quot;</span> :</span><br><span class="line">                                propertyValue = Long.valueOf(value);</span><br><span class="line">                                <span class="keyword">break</span>;</span><br><span class="line">                            <span class="keyword">case</span> <span class="string">&quot;short&quot;</span> : <span class="keyword">case</span> <span class="string">&quot;Short&quot;</span>:</span><br><span class="line">                                propertyValue = Short.valueOf(value);</span><br><span class="line">                                <span class="keyword">break</span>;</span><br><span class="line">                            <span class="keyword">case</span> <span class="string">&quot;boolean&quot;</span>: <span class="keyword">case</span> <span class="string">&quot;Boolean&quot;</span>:</span><br><span class="line">                                propertyValue = Boolean.valueOf(value);</span><br><span class="line">                                <span class="keyword">break</span>;</span><br><span class="line">                            <span class="keyword">case</span> <span class="string">&quot;char&quot;</span> : <span class="keyword">case</span> <span class="string">&quot;Character&quot;</span> :</span><br><span class="line">                                propertyValue = value.charAt(<span class="number">0</span>);</span><br><span class="line">                                <span class="keyword">break</span>;</span><br><span class="line">                            <span class="keyword">default</span>:</span><br><span class="line">                                propertyValue = value;</span><br><span class="line">                       </span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        setMethod.invoke(beanMap.get(id), propertyValue);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                   e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">        &#125;);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">getBean</span><span class="params">(String beanId)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> beanMap.get(beanId);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="10-IoC注解式开发"><a href="#10-IoC注解式开发" class="headerlink" title="10. IoC注解式开发"></a>10. IoC注解式开发</h2><h3 id="10-1-回顾注解开发"><a href="#10-1-回顾注解开发" class="headerlink" title="10.1 回顾注解开发"></a>10.1 回顾注解开发</h3><h4 id="10-1-1注解的意义"><a href="#10-1-1注解的意义" class="headerlink" title="10.1.1注解的意义"></a>10.1.1注解的意义</h4><ul>
<li>在Spring中引入注解的目的是为了简化繁琐的配置过程</li>
</ul>
<h4 id="10-1-2-注解中属性的定义"><a href="#10-1-2-注解中属性的定义" class="headerlink" title="10.1.2 注解中属性的定义"></a>10.1.2 注解中属性的定义</h4><blockquote>
<p>代码</p>
</blockquote>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target(&#123;ElementType.TYPE&#125;)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Component &#123;</span><br><span class="line">    String <span class="title function_">value</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>说明</p>
</blockquote>
<ul>
<li>类型 : @interface</li>
<li>字段 : 是未来可以在注解中填写的内容, 会被存放在这个注解类中, 未来也可以通过获取到这个注解类从而获取到其中的值</li>
<li>元注解<ul>
<li>上面的@Target和@Retention都被称为元注解, 是用来修饰注解的注解</li>
<li>@Retention : 注解的保持性策略, 规定了注解什么时候可以被反射机制读取, 定义了注解的生命周期, 在什么时候可以访问<ul>
<li>SOURCE : 注解只在源码中保存, 编译时会被丢弃, 用于编译检查工具</li>
<li>CLASS(默认) : 注解会保留在<code>.class</code>文件中, 但运行的时候无法通过反射获取, 用于编译器和工具使用(Lombok)</li>
<li>RUNTIME : 注解会一直保留到运行的时候, 可以通过反射获取</li>
</ul>
</li>
<li>@Target : 注解可以修饰的位置, 也就是注解可以放在什么东西上面, 有方法, 类, 属性…</li>
</ul>
</li>
</ul>
<h4 id="10-1-3-通过反射机制读取注解"><a href="#10-1-3-通过反射机制读取注解" class="headerlink" title="10.1.3 通过反射机制读取注解"></a>10.1.3 通过反射机制读取注解</h4><ol>
<li>设置包名, 获取到包的绝对路径</li>
<li>获取到包下面的所有的文件流</li>
<li>以流的方式载入, forEach遍历 (流式获取更多的是代码规范, 实际上直接遍历files也是可以的)<ol>
<li>通过文件名以及包名, 获取到完整的类路径名</li>
<li>反射获取类, 检查该类是否有该注解</li>
<li>从类中获取注解. 解析注解</li>
<li>通过注解创建实例并存入map中</li>
</ol>
</li>
</ol>
<h4 id="10-1-4-完整代码"><a href="#10-1-4-完整代码" class="headerlink" title="10.1.4 完整代码"></a>10.1.4 完整代码</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">HashMap&lt;String, Object&gt; beanMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line"><span class="type">String</span> <span class="variable">packageName</span> <span class="operator">=</span> <span class="string">&quot;com.func.spring&quot;</span>;</span><br><span class="line"><span class="type">String</span> <span class="variable">packagePath</span> <span class="operator">=</span> packageName.replaceAll(<span class="string">&quot;\\.&quot;</span>, <span class="string">&quot;/&quot;</span>);</span><br><span class="line"><span class="type">URL</span> <span class="variable">url</span> <span class="operator">=</span> ClassLoader.getSystemClassLoader().getResource(packagePath);</span><br><span class="line">System.out.println(url);</span><br><span class="line"><span class="type">File</span> <span class="variable">f</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(url.getPath());</span><br><span class="line">File[] files = f.listFiles();</span><br><span class="line">Arrays.stream(files).forEach(file -&gt; &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">fileName</span> <span class="operator">=</span> file.getName();</span><br><span class="line">    <span class="type">String</span> <span class="variable">className</span> <span class="operator">=</span> packageName + <span class="string">&quot;.&quot;</span> +  fileName.split(<span class="string">&quot;\\.&quot;</span>)[<span class="number">0</span>];</span><br><span class="line">    System.out.println(className);</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        Class&lt;?&gt; clazz = Class.forName(className);</span><br><span class="line">        <span class="keyword">if</span> (clazz.isAnnotationPresent(Component.class)) &#123;</span><br><span class="line">            <span class="type">Component</span> <span class="variable">component</span> <span class="operator">=</span> clazz.getAnnotation(Component.class);</span><br><span class="line">            <span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> component.value();</span><br><span class="line">            Constructor&lt;?&gt; constructor = clazz.getConstructor(String.class);</span><br><span class="line">            <span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> constructor.newInstance(value);</span><br><span class="line">            beanMap.put(value, o);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">System.out.println(beanMap);</span><br></pre></td></tr></table></figure>

<h3 id="10-2-Bean的注解种类"><a href="#10-2-Bean的注解种类" class="headerlink" title="10.2 Bean的注解种类"></a>10.2 Bean的注解种类</h3><blockquote>
<p>四种注解类型 : 通过观察源码, 其实可以得出, 另外三种注解类型, 其实只是@Component的别名, 所以不同类的注解更多的是为了增强可读性</p>
</blockquote>
<ul>
<li>@Component</li>
<li>@Service</li>
<li>@Controller</li>
<li>@Repository</li>
</ul>
<blockquote>
<p>源码</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target(&#123;ElementType.TYPE&#125;)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Indexed</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Component &#123;</span><br><span class="line">    String <span class="title function_">value</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>注解只能放在类上, 可以通过反射获取</li>
</ul>
<h3 id="10-3-注解的使用"><a href="#10-3-注解的使用" class="headerlink" title="10.3 注解的使用"></a>10.3 注解的使用</h3><h4 id="10-3-1-使用注解"><a href="#10-3-1-使用注解" class="headerlink" title="10.3.1 使用注解"></a>10.3.1 使用注解</h4><blockquote>
<p>添加注解, 填入的value就是BeanId</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component(&quot;user&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="meta">@Value(&quot;UserName&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>XML中扫描含有注解的类</p>
</blockquote>
<ul>
<li>先要添加context命名空间</li>
<li>指定要扫描的包</li>
<li>如果有多个包, 可以用 <code>,</code> 隔开, 或者填入父包的地址</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="line">&lt;beans</span><br><span class="line">       xmlns=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span><br><span class="line">       xmlns:context=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span><br><span class="line">       xmlns:xsi=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="line">       xsi:schemaLocation=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span></span><br><span class="line"><span class="string">                            http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">        &lt;context:component-scan base-<span class="keyword">package</span>=<span class="string">&quot;com.func.spring&quot;</span> use-<span class="keyword">default</span>-filters=<span class="string">&quot;true&quot;</span>&gt;</span><br><span class="line">                &lt;context:exclude-filter type=<span class="string">&quot;annotation&quot;</span> expression=<span class="string">&quot;org.springframework.stereotype.Component&quot;</span>/&gt;&lt;/context:component-scan&gt;</span><br><span class="line">&lt;/beans&gt;</span><br></pre></td></tr></table></figure>
<h4 id="10-3-2-选择性实例化Bean"><a href="#10-3-2-选择性实例化Bean" class="headerlink" title="10.3.2 选择性实例化Bean"></a>10.3.2 选择性实例化Bean</h4><blockquote>
<p>我们可以选择化实例某一类的注解</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.func.spring&quot;</span> <span class="attr">use-default-filters</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">context:exclude-filter</span> <span class="attr">type</span>=<span class="string">&quot;annotation&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;org.springframework.stereotype.Component&quot;</span>/&gt;</span><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>use-default-filters<ul>
<li>true使用默认的过滤器, 相当于不过滤, 所有注解bean还是会被实例化</li>
<li>false不使用…, 会不初始化所有的注解bean</li>
</ul>
</li>
<li>exclude-filter(include-filter) <ul>
<li>需要排除(添加)的注解的种类, 填入种类的注解bean会被不实例化(实例化)</li>
</ul>
</li>
</ul>
<h3 id="10-4-负责注入的注解"><a href="#10-4-负责注入的注解" class="headerlink" title="10.4 负责注入的注解"></a>10.4 负责注入的注解</h3><blockquote>
<p>简单类型的注入</p>
</blockquote>
<ol>
<li>在属性名上填写 <code>@Value</code>, 通过这种方式, 可以不些setter方法</li>
<li>在属性对应的setter方法上 <code>@Value</code></li>
<li>在构造方法的参数列表对应属性前填入 <code>@Value</code></li>
</ol>
<blockquote>
<p>代码</p>
</blockquote>
<ul>
<li>属性名</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service(&quot;vip&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Vip</span> &#123;</span><br><span class="line">    <span class="meta">@Value(&quot;vipN&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>构造方法</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component(&quot;user&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line"><span class="comment">//    @Value(&quot;UserName&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">User</span><span class="params">(<span class="meta">@Value(&quot;方&quot;)</span> String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>非简单类型</p>
</blockquote>
<blockquote>
<p>通过AutoWrited注入</p>
</blockquote>
<ul>
<li>使用和@Vaule一样, 不过AutoWrited是自动装配, 和之前的xml中的auto-write一样</li>
<li>不过是byType</li>
<li>如果不写, Spring也会自动帮你装配非简单类型, 只不过这需要该类只有一个构造方法, 不然会报错</li>
</ul>
<blockquote>
<p>@Qualifier</p>
</blockquote>
<ul>
<li>如果想通过byName自动装配</li>
<li>需要再额外配合上@Qualifier(“name”) 注解来进行匹配</li>
</ul>
<blockquote>
<p>@Resource</p>
</blockquote>
<ul>
<li>属于JDK拓展包, 需要额外导入</li>
<li>是通过byName方式找到bean的</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.annotation<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.annotation-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>代码</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Resource(name = &quot;vip&quot;)</span></span><br><span class="line"><span class="keyword">private</span> Vip vip;</span><br></pre></td></tr></table></figure>
<h3 id="10-5-全注解式开发"><a href="#10-5-全注解式开发" class="headerlink" title="10.5 全注解式开发"></a>10.5 全注解式开发</h3><blockquote>
<p>不再通过xml配置文件, 而是通过配置类配置</p>
</blockquote>
<ul>
<li>配置类</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(&#123;&quot;com.func.spring&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Spring6Configuration</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>加载配置类</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">AnnotationConfigApplicationContext</span> <span class="variable">annotationConfigApplicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationContext</span>(Spring6Configuration.class);</span><br><span class="line"><span class="type">Object</span> <span class="variable">user</span> <span class="operator">=</span> annotationConfigApplicationContext.getBean(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">System.out.println(user.toString());</span><br></pre></td></tr></table></figure>

<h2 id="11-GoF之代理模式"><a href="#11-GoF之代理模式" class="headerlink" title="11. GoF之代理模式"></a>11. GoF之代理模式</h2><p>[[Spring中的设计模式#2. GoF之代理模式 (结构型设计模式)]]</p>
<h2 id="12-面向切面编程AOP"><a href="#12-面向切面编程AOP" class="headerlink" title="12. 面向切面编程AOP"></a>12. 面向切面编程AOP</h2><h3 id="12-1-AOP的介绍"><a href="#12-1-AOP的介绍" class="headerlink" title="12.1 AOP的介绍"></a>12.1 AOP的介绍</h3><h4 id="什么是AOP"><a href="#什么是AOP" class="headerlink" title="什么是AOP"></a>什么是AOP</h4><ul>
<li>是OOP的延申拓展, 在面对对象基础上, 进一步提取出来公共组件和行为</li>
<li>这样的公共组件, 我们也称为程序的横切面, 所以AOP是一种面向横切面编程的思想, 这样的公共组件有 (日志记录, 权限控制, 事务管理等)</li>
<li>不同于通过公共工具类的方式实现这种提取, AOP采取了更自动化的方式 : 代理模式</li>
</ul>
<h4 id="AOP和代理模式"><a href="#AOP和代理模式" class="headerlink" title="AOP和代理模式"></a>AOP和代理模式</h4><ul>
<li>代理模式可以看作是AOP的实现, 通过动态的代理, 可以很轻松的实现AOP, 会自动的在我们需要的位置增强代码</li>
<li>同时最关键的是, 这是一种非侵入式的实现, 遵守了OCP开闭原则</li>
</ul>
<h4 id="Spring-中的-AOP"><a href="#Spring-中的-AOP" class="headerlink" title="Spring 中的 AOP"></a>Spring 中的 AOP</h4><ul>
<li>Spring中主要通过JDK 动态代理和cglib代理实现<ul>
<li>如果代理的是接口类, 或者代理的类实现了接口, 使用JDK</li>
<li>没有实现接口的类, 则使用的是cglib实现</li>
<li>也可以在后续的配置文件中指定实现方式</li>
</ul>
</li>
</ul>
<h3 id="12-2-AOP相关术语"><a href="#12-2-AOP相关术语" class="headerlink" title="12.2 AOP相关术语"></a>12.2 AOP相关术语</h3><ul>
<li>目标对象 Target<ul>
<li>被织入的对象</li>
</ul>
</li>
<li>代理对象 Proxy<ul>
<li>一个目标对象被织入通知后产生的新的对象</li>
</ul>
</li>
<li>织入 Weaving<ul>
<li>把通知应用到目标对象上的过程</li>
</ul>
</li>
<li>通知 Advice<ul>
<li>也叫增强, 就是具体要织入的代码</li>
<li>种类有<ul>
<li>环绕通知</li>
<li>前置通知</li>
<li>后置通知</li>
<li>异常通知</li>
<li>最终通知</li>
</ul>
</li>
</ul>
</li>
<li>切点 Pointcut<ul>
<li>织入了切面的方法</li>
</ul>
</li>
<li>连接点 Joinpoint<ul>
<li>可以织入切面的位置, 种类和通知的种类对应</li>
</ul>
</li>
</ul>
<h3 id="12-3-切点表达式"><a href="#12-3-切点表达式" class="headerlink" title="12.3 切点表达式"></a>12.3 切点表达式</h3><p>切点表达式用于定义通知被切入的方法</p>
<p>切入点表达式语法格式：</p>
<p><code>execution([访问控制权限修饰符] 返回值类型 [全限定类名]方法名(形式参数列表) [异常])</code></p>
<p>访问控制权限修饰符：</p>
<ul>
<li>可选项。</li>
<li>没写，就是4个权限都包括。</li>
<li>写public就表示只包括公开的方法。</li>
</ul>
<p>返回值类型：</p>
<ul>
<li>必填项。</li>
<li>*表示返回值类型任意。</li>
</ul>
<p>全限定类名：</p>
<ul>
<li>可选项。</li>
<li>两个点“..”代表当前包以及子包下的所有类。</li>
<li>省略时表示所有的类。</li>
</ul>
<p>方法名：</p>
<ul>
<li>必填项。</li>
<li>*表示所有方法。</li>
<li>set*表示所有的set方法。</li>
</ul>
<p>形式参数列表：</p>
<ul>
<li>必填项</li>
<li>() 表示没有参数的方法</li>
<li>(..) 参数类型和个数随意的方法</li>
<li>(*) 只有一个参数的方法</li>
<li>(*, String) 第一个参数类型随意，第二个参数是String的。</li>
</ul>
<p>异常：</p>
<ul>
<li>可选项。</li>
<li>省略时表示任意异常类型。</li>
</ul>
<h3 id="12-4-使用Spring的AOP"><a href="#12-4-使用Spring的AOP" class="headerlink" title="12.4 使用Spring的AOP"></a>12.4 使用Spring的AOP</h3><h4 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h4><ul>
<li>导入依赖spring-aspects</li>
<li>在xml文件中添加context和aop的命名空间</li>
</ul>
<h4 id="复用和执行顺序"><a href="#复用和执行顺序" class="headerlink" title="复用和执行顺序"></a>复用和执行顺序</h4><ul>
<li>可以将<strong>切点复用</strong>, 提取出来, 被修饰的方法并不会真的被执行, 只是给一个方这个方法的位置,  设置<code>@Pointcut</code>注解</li>
<li>可以通过设置<code>@order(整数)</code>来控制切面的执行顺序, 数字越小优先级越高</li>
</ul>
<h4 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h4><ol>
<li>创建与编写切面类</li>
<li>配置配置文件</li>
</ol>
<h4 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h4><h5 id="切面类"><a href="#切面类" class="headerlink" title="切面类"></a>切面类</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyAspect</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Pointcut(&quot;execution(* com.func.spring.aop.OrderService.*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">pointcut</span><span class="params">()</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before(&quot;pointcut()&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">beforeAdvice</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;前置通知&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Around(&quot;pointcut()&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">aroundAdvice</span><span class="params">(ProceedingJoinPoint proceedingJoinPoint)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;环绕通知开始&quot;</span>);</span><br><span class="line">        <span class="comment">// 执行目标方法</span></span><br><span class="line">        proceedingJoinPoint.proceed();</span><br><span class="line">        System.out.println(<span class="string">&quot;环绕通知开始&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@AfterReturning(&quot;pointcut()&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterAdvice</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;后置通知&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@AfterThrowing(&quot;pointcut()&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">throwingAdvice</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;异常通知&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@After(&quot;pointcut()&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">finalAdvice</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;最终通知&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="xml配置文件"><a href="#xml配置文件" class="headerlink" title="xml配置文件"></a>xml配置文件</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:aop</span>=<span class="string">&quot;http://www.springframework.org/schema/aop&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.func.spring.aop&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--使用cglib方式动态代理--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:aspectj-autoproxy</span> <span class="attr">expose-proxy</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--生成代理对象--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:aspectj-autoproxy</span> <span class="attr">proxy-target-class</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>proxy-target-class : 默认为false, 这个时候就是介绍AOP的时候说明的动态代理顺序, 如果为true则全程使用cglib执行动态代理</li>
<li>expose-proxy : 为true的时候, 但是带有@Aspect注解的bean都会生成代理对象<ul>
<li>问题背景 : 如果在目标类的方法中调用了另一个方法, 这个时候目标方法内部的自己的其他方法, 是该类自己调用的, 因为不是通过代理对象调用的, 增强逻辑将不会生效</li>
<li>这个时候, 想让那个内部执行的自己的方法也执行增强逻辑, 就可以让这个参数为true, 暴露代理对象, 然后通过当前线程获取代理对象, 在内部调用中使用代理对象, 从而触发增强逻辑<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">insert</span><span class="params">()</span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;正在插入数据&quot;</span>);</span><br><span class="line">    <span class="type">OrderService</span> <span class="variable">proxy</span> <span class="operator">=</span> (OrderService) AopContext.currentProxy();</span><br><span class="line">    proxy.delete();</span><br><span class="line">    System.out.println(<span class="string">&quot;proxy = &quot;</span> + proxy);</span><br><span class="line">    System.out.println(<span class="string">&quot;this = &quot;</span> + <span class="built_in">this</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>这种方式是带有一定的侵入性的</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="执行结果"><a href="#执行结果" class="headerlink" title="执行结果"></a>执行结果</h4><ul>
<li>不带有异常的</li>
</ul>
<figure class="highlight plaintext"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">环绕通知开始</span><br><span class="line">前置通知</span><br><span class="line">aspect2环绕通知开始</span><br><span class="line">aspect2前置通知</span><br><span class="line">正在添加数据</span><br><span class="line">aspect2后置通知</span><br><span class="line">aspect2最终通知</span><br><span class="line">aspect2环绕通知开始</span><br><span class="line">后置通知</span><br><span class="line">最终通知</span><br><span class="line">环绕通知开始</span><br></pre></td></tr></table></figure>

<ul>
<li>带有异常的</li>
</ul>
<figure class="highlight plaintext"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">环绕通知开始</span><br><span class="line">前置通知</span><br><span class="line">aspect2环绕通知开始</span><br><span class="line">aspect2前置通知</span><br><span class="line">正在添加数据</span><br><span class="line">aspect2异常通知</span><br><span class="line">aspect2最终通知</span><br><span class="line">异常通知</span><br><span class="line">最终通知</span><br></pre></td></tr></table></figure>

<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><ul>
<li>如果实现了环绕通知, 因为环绕通知需要能够在方法的执行前后都进行通知, 所以有环绕通知后, 方法的执行需要手动调用</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Around(&quot;pointcut()&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">aroundAdvice</span><span class="params">(ProceedingJoinPoint proceedingJoinPoint)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;环绕通知开始&quot;</span>);</span><br><span class="line">    <span class="comment">// 执行目标方法</span></span><br><span class="line">    proceedingJoinPoint.proceed();</span><br><span class="line">    System.out.println(<span class="string">&quot;环绕通知开始&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>执行顺序 : 其实看运行结果和环绕执行的机制很容易知道, 不再赘述</li>
<li>如果有异常, 那么后置方法是不会执行的, 因为没有return这个环节, 但是最终通知是会执行的, 因为该类型的通知, 其实是被放到<code>finally&#123;&#125;</code>代码块中执行的</li>
</ul>
<h4 id="全注解开发"><a href="#全注解开发" class="headerlink" title="全注解开发"></a>全注解开发</h4><ul>
<li>在注解类上再加个<code>@EnableAspectJAutoProxy()</code>的注解就行</li>
<li>代码</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.func.spring.aop&quot;)</span></span><br><span class="line"><span class="meta">@EnableAspectJAutoProxy(exposeProxy = true)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringConfiguration</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="12-5-xml开发-不推荐"><a href="#12-5-xml开发-不推荐" class="headerlink" title="12.5 xml开发(不推荐)"></a>12.5 xml开发(不推荐)</h3><ul>
<li>只给出实例代码</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;timer&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.func.spring.aop.TimerAspect&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;order&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.func.spring.aop.OrderService&quot;</span>/&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">&lt;!--aop配置--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--切面表达式--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">&quot;pointcut&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;execution(* com.func.spring.aop.OrderService.* (..))&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--切面--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:aspect</span> <span class="attr">ref</span>=<span class="string">&quot;timer&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:around</span> <span class="attr">method</span>=<span class="string">&quot;time&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;pointcut&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">aop:aspect</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="12-6-应用案例"><a href="#12-6-应用案例" class="headerlink" title="12.6 应用案例"></a>12.6 应用案例</h3><p>[[Spring6_语雀版讲义#15.5 AOP的实际案例：事务处理]]<br>[[Spring6_语雀版讲义#15.6 AOP的实际案例：安全日志]]</p>
<h2 id="13-Spring对事务的支持-JdbcTemplate"><a href="#13-Spring对事务的支持-JdbcTemplate" class="headerlink" title="13. Spring对事务的支持 (JdbcTemplate)"></a>13. Spring对事务的支持 (JdbcTemplate)</h2><p>[[Spring6_语雀版讲义#16.1 事务概述]]</p>
<h2 id="14-Spring6整合Junit5"><a href="#14-Spring6整合Junit5" class="headerlink" title="14. Spring6整合Junit5"></a>14. Spring6整合Junit5</h2><p>[[Spring6_语雀版讲义#十七、Spring6整合JUnit5]]</p>
<h2 id="15-Spring6集成Mabatis"><a href="#15-Spring6集成Mabatis" class="headerlink" title="15. Spring6集成Mabatis"></a>15. Spring6集成Mabatis</h2><p>[[Spring6_语雀版讲义#十八、Spring6集成MyBatis3.5]]</p>
<h2 id="16-Spring中的八大模式"><a href="#16-Spring中的八大模式" class="headerlink" title="16. Spring中的八大模式"></a>16. Spring中的八大模式</h2><p>[[Spring6_语雀版讲义#十九、Spring中的八大模式]]</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://fang-tech.github.io">Func</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://fang-tech.github.io/2025/07/08/Java/Spring/Spring_/Spring/">https://fang-tech.github.io/2025/07/08/Java/Spring/Spring_/Spring/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://fang-tech.github.io" target="_blank">走难</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Spring/">Spring</a><a class="post-meta__tags" href="/tags/IoC/">IoC</a><a class="post-meta__tags" href="/tags/DI/">DI</a><a class="post-meta__tags" href="/tags/AOP/">AOP</a><a class="post-meta__tags" href="/tags/Bean%E7%AE%A1%E7%90%86/">Bean管理</a><a class="post-meta__tags" href="/tags/%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5/">依赖注入</a><a class="post-meta__tags" href="/tags/%E9%9D%A2%E5%90%91%E5%88%87%E9%9D%A2%E7%BC%96%E7%A8%8B/">面向切面编程</a></div><div class="post-share"><div class="social-share" data-image="https://raw.githubusercontent.com/fang-tech/Pic/main/img/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20250709003827.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/07/08/Java/Spring/SpringMVC/SpringMVC/" title="SpringMVC核心概念与实践"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">SpringMVC核心概念与实践</div></div><div class="info-2"><div class="info-item-1">SpringMVC1. RESTful与注解上的细节1.1 类上的ResultMapping注解 类上的ResultMapping注解, 会让类中方法的resultMapping从类上的路径开始  不过这个时候注意返回的html路径问题, 访问的根路径是templates文件夹, 如果在里面有子文件夹, 注意写全文件夹  User   12345678@RequestMapping(&quot;/product&quot;)@Controllerpublic class UserController &#123;    @RequestMapping(&quot;/detail&quot;)    public String toDetail()&#123;        return &quot;/product/detail&quot;;    &#125;&#125;   Product  12345678@RequestMapping(&quot;/user&quot;)@Controllerpublic class ProductController &#123;   ...</div></div></div></a><a class="pagination-related" href="/2025/07/08/Java/Spring/SpringBoot/SpringBoot/" title="SpringBoot核心功能详解"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">SpringBoot核心功能详解</div></div><div class="info-2"><div class="info-item-1">1. 加载外部配置1.1 application.properties这是springboot默认的加载的外部配置, 是java常用的properties类型的文件, 采用键值对的形式存储值, 通过object.filed的方式创建对象 1234spring.application.name=sb3-003-external-configmyapp.username=jackmyapp.email=jack@123.commyapp.age=30  1.2 bean对象获取配置文件中的值 通过@Value(“${key:defult}”)的形式获取配置文件中的值  1234567891011121314151617@Service(&quot;UserService&quot;)public class UserServiceImpl implements UserService &#123;    @Value(&quot;$&#123;myapp.username&#125;&quot;)    private String username;    @Value(&quot...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/07/08/Java/Spring/Spring%E4%B8%AD%E7%9A%84%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/Spring%E4%B8%AD%E7%9A%84%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" title="Spring中的设计模式"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-08</div><div class="info-item-2">Spring中的设计模式</div></div><div class="info-2"><div class="info-item-1">1. 工厂模式2. GoF之代理模式 (结构型设计模式)2.1 代理模式简介为什么需要代理模式间接访问 在程序中A和B无法直接交互, 可以通过代理C完成A &lt;-&gt; C &lt;-&gt; B以完成交互  增强功能 程序的功能需要增强时, 可以通过套一层代理模式, 让代理模式实现额外的功能 使代码更灵活, 遵循OCP  保护 程序中, 目标需要被保护时, 我们可能需要控制访问权限,  增加额外的控制逻辑  代理模式中的角色![[image (1).png]]  目标类 (真实主题) 代理类 (代理主题) 代理类和目标类的公共接口 (抽象主题) : 客户端在使用代理类的时候就像在使用目标类, 所以代理类和目标类要实现共同的接口  2.2 静态代理业务场景三种解决模式 继承式   优点 相较于将代码直接重新复制黏贴到代理类上, 不用修改源代码, 符合OCP开闭原则   缺点 采用继承式关系, 代码耦合度高 需要为每个实现类编写代理类, 类膨胀    1234567891011121314151617181920212223242526public class OrderSe...</div></div></div></a><a class="pagination-related" href="/2025/07/08/Project/wrench/%E8%BF%87%E7%A8%8B%E7%AC%94%E8%AE%B0/3-%E5%8A%A8%E6%80%81%E9%99%90%E6%B5%81/" title="Wrench项目解析02 - 动态限流组件实现"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-08</div><div class="info-item-2">Wrench项目解析02 - 动态限流组件实现</div></div><div class="info-2"><div class="info-item-1">动态限流组件程序的串行执行过程 @RateLimiterAccessInterceptor注解到需要拦截的方法上  123456789101112@Target(ElementType.METHOD)@Retention(RetentionPolicy.RUNTIME)@Documentedpublic @interface RateLimiterAccessInterceptor &#123;    String key() default &quot;all&quot;;    // 限制频次: 每秒请求次数    double permitsPerSecond();    // 黑名单拦截: 多少次限制以后加入到黑名单, 0代表不做限制    double blacklistCount() default 0;    // 拦截后执行的方法    String fallbackMethod();&#125;   RateLimiterAOP对象拦截所有被@RateLimiterAccessInterceptor注解的方法 通过第一节的DCC来动态配置限流组件的状态(打开还是...</div></div></div></a></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="https://raw.githubusercontent.com/fang-tech/Pic/main/img/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20250709003827.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Func</div><div class="author-info-description">Func的个人博客</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">131</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">271</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">48</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/fang-tech"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-IoC%E6%B3%A8%E5%85%A5"><span class="toc-number">1.</span> <span class="toc-text">2. IoC注入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-set%E6%B3%A8%E5%85%A5"><span class="toc-number">1.1.</span> <span class="toc-text">2.1 set注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E6%9E%84%E9%80%A0%E6%B3%A8%E5%85%A5"><span class="toc-number">1.2.</span> <span class="toc-text">2.2 构造注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-%E6%B3%A8%E5%85%A5%E8%BF%87%E7%A8%8B%E8%AF%B4%E6%98%8E"><span class="toc-number">1.3.</span> <span class="toc-text">2.3 注入过程说明</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-set%E6%B3%A8%E5%85%A5%E4%B8%93%E9%A2%98"><span class="toc-number">1.4.</span> <span class="toc-text">2.4 set注入专题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-1-%E5%86%85%E9%83%A8bean%E5%92%8C%E5%A4%96%E9%83%A8bean"><span class="toc-number">1.4.1.</span> <span class="toc-text">2.4.1 内部bean和外部bean</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-2-%E6%B3%A8%E5%85%A5%E7%AE%80%E5%8D%95%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.4.2.</span> <span class="toc-text">2.4.2 注入简单类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-3-%E7%AE%80%E5%8D%95%E7%B1%BB%E5%9E%8B%E7%9A%84%E6%B3%A8%E5%85%A5%E7%9A%84%E7%BB%8F%E5%85%B8%E5%BA%94%E7%94%A8"><span class="toc-number">1.4.3.</span> <span class="toc-text">2.4.3 简单类型的注入的经典应用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-4-%E6%B3%A8%E5%85%A5%E6%95%B0%E7%BB%84"><span class="toc-number">1.4.4.</span> <span class="toc-text">2.4.4 注入数组</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-5-Set%E9%9B%86%E5%90%88-Map%E9%9B%86%E5%90%88-Properties%E7%B1%BB%E5%9E%8B%E6%B3%A8%E5%85%A5"><span class="toc-number">1.4.5.</span> <span class="toc-text">2.4.5 Set集合, Map集合, Properties类型注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-6-%E6%B3%A8%E5%85%A5%E7%89%B9%E6%AE%8A%E5%AD%97%E7%AC%A6%E4%B8%8Enull"><span class="toc-number">1.4.6.</span> <span class="toc-text">2.4.6 注入特殊字符与null</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-%E5%9F%BA%E4%BA%8E%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4%E7%9A%84%E6%B3%A8%E5%85%A5%E5%92%8C%E9%85%8D%E7%BD%AE%E5%A4%8D%E7%94%A8"><span class="toc-number">1.5.</span> <span class="toc-text">2.5 基于命名空间的注入和配置复用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-6-%E5%9F%BA%E4%BA%8EXML%E7%9A%84%E8%87%AA%E5%8A%A8%E8%A3%85%E9%85%8D"><span class="toc-number">1.6.</span> <span class="toc-text">2.6 基于XML的自动装配</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-7-XML%E8%A3%85%E9%85%8D%E5%A4%96%E9%83%A8%E8%B5%84%E6%BA%90%E6%96%87%E4%BB%B6"><span class="toc-number">1.7.</span> <span class="toc-text">2.7  XML装配外部资源文件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-Bean%E7%9A%84%E4%BD%9C%E7%94%A8%E5%9F%9F"><span class="toc-number">2.</span> <span class="toc-text">3. Bean的作用域</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-Bean%E4%BD%9C%E7%94%A8%E5%9F%9F%E4%B9%8B%E5%8D%95%E4%BE%8B%E5%92%8C%E5%A4%9A%E4%BE%8B"><span class="toc-number">2.1.</span> <span class="toc-text">3.1 Bean作用域之单例和多例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E8%87%AA%E5%AE%9A%E4%B9%89scope"><span class="toc-number">2.2.</span> <span class="toc-text">3.2 自定义scope</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-GoF%E4%B9%8B%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F"><span class="toc-number">3.</span> <span class="toc-text">4. GoF之工厂模式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-Bean"><span class="toc-number">4.</span> <span class="toc-text">5. Bean</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-Bean%E7%9A%84%E5%9B%9B%E7%A7%8D%E5%AE%9E%E4%BE%8B%E5%8C%96%E6%96%B9%E6%B3%95"><span class="toc-number">4.1.</span> <span class="toc-text">5.1 Bean的四种实例化方法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-1-1-%E9%80%9A%E8%BF%87%E6%9E%84%E9%80%A0%E6%96%B9%E6%B3%95%E7%9A%84%E5%AE%9E%E4%BE%8B%E5%8C%96"><span class="toc-number">4.1.1.</span> <span class="toc-text">5.1.1 通过构造方法的实例化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-1-2-%E9%80%9A%E8%BF%87%E7%AE%80%E5%8D%95%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F%E5%AE%9E%E4%BE%8B%E5%8C%96"><span class="toc-number">4.1.2.</span> <span class="toc-text">5.1.2 通过简单工厂模式实例化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-1-3-%E9%80%9A%E8%BF%87factory-bean%E5%AE%9E%E4%BE%8B%E5%8C%96"><span class="toc-number">4.1.3.</span> <span class="toc-text">5.1.3 通过factory-bean实例化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-1-4-%E9%80%9A%E8%BF%87FactoryBean%E6%8E%A5%E5%8F%A3%E5%AE%9E%E4%BE%8B%E5%8C%96"><span class="toc-number">4.1.4.</span> <span class="toc-text">5.1.4 通过FactoryBean接口实例化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-1-5-Bean%E5%B7%A5%E5%8E%82%E5%AE%9E%E4%BE%8B%E5%8C%96%E6%96%B9%E6%B3%95%E7%9A%84%E5%AE%9E%E9%99%85%E8%BF%90%E8%A1%8C"><span class="toc-number">4.1.5.</span> <span class="toc-text">5.1.5 Bean工厂实例化方法的实际运行</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-Bean%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-number">5.</span> <span class="toc-text">6. Bean的生命周期</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-Bean%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E4%B9%8B%E4%BA%94%E6%AD%A5"><span class="toc-number">5.1.</span> <span class="toc-text">6.1 Bean的生命周期之五步</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-Bean%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E4%B9%8B%E4%B8%83%E6%AD%A5"><span class="toc-number">5.2.</span> <span class="toc-text">6.2 Bean生命周期之七步</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3-Bean%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E4%B9%8B%E5%8D%81%E6%AD%A5"><span class="toc-number">5.3.</span> <span class="toc-text">6.3 Bean的生命周期之十步</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-4-%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E4%B9%8B%E4%B8%8D%E5%90%8C%E4%BD%9C%E7%94%A8%E5%9F%9F"><span class="toc-number">5.4.</span> <span class="toc-text">6.4 生命周期之不同作用域</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-5-%E5%A6%82%E4%BD%95%E8%AE%A9%E8%87%AA%E5%B7%B1new%E7%9A%84%E5%AF%B9%E8%B1%A1%E7%BB%99Spring%E7%AE%A1%E7%90%86"><span class="toc-number">5.5.</span> <span class="toc-text">6.5 如何让自己new的对象给Spring管理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-Bean%E7%9A%84%E5%BE%AA%E7%8E%AF%E4%BE%9D%E8%B5%96"><span class="toc-number">6.</span> <span class="toc-text">7. Bean的循环依赖</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#7-1-%E9%80%9A%E8%BF%87setter%E5%AE%9E%E4%BE%8B%E5%8C%96%E7%9A%84bean%E5%AF%B9%E8%B1%A1"><span class="toc-number">6.0.1.</span> <span class="toc-text">7.1 通过setter实例化的bean对象</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-%E9%80%9A%E8%BF%87%E6%9C%89%E5%8F%82%E6%9E%84%E9%80%A0%E5%99%A8%E5%AE%9E%E4%BE%8B%E5%8C%96bean%E5%AF%B9%E8%B1%A1"><span class="toc-number">6.1.</span> <span class="toc-text">7.2 通过有参构造器实例化bean对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-3-Bean%E7%9A%84%E5%BE%AA%E7%8E%AF%E4%BE%9D%E8%B5%96%E4%B9%8B%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90"><span class="toc-number">6.2.</span> <span class="toc-text">7.3 Bean的循环依赖之源码分析</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-%E5%9B%9E%E9%A1%BE%E5%8F%8D%E5%B0%84%E6%9C%BA%E5%88%B6"><span class="toc-number">7.</span> <span class="toc-text">8.回顾反射机制</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-%E6%89%8B%E5%86%99spring%E6%A1%86%E6%9E%B6"><span class="toc-number">8.</span> <span class="toc-text">9. 手写spring框架</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#9-1-%E5%88%9B%E5%BB%BA%E7%9B%B8%E5%85%B3%E7%B1%BB"><span class="toc-number">8.1.</span> <span class="toc-text">9.1 创建相关类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-2-%E5%88%9B%E5%BB%BAbean%E5%AE%9E%E4%BE%8B%E5%B9%B6%E5%AD%98%E5%82%A8%E5%88%B0map%E4%B8%AD"><span class="toc-number">8.2.</span> <span class="toc-text">9.2 创建bean实例并存储到map中</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-3-%E7%BB%99bean%E7%9A%84%E5%B1%9E%E6%80%A7%E8%B5%8B%E5%80%BC"><span class="toc-number">8.3.</span> <span class="toc-text">9.3 给bean的属性赋值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-4-%E5%AE%8C%E6%95%B4%E6%BA%90%E7%A0%81"><span class="toc-number">8.4.</span> <span class="toc-text">9.4 完整源码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-IoC%E6%B3%A8%E8%A7%A3%E5%BC%8F%E5%BC%80%E5%8F%91"><span class="toc-number">9.</span> <span class="toc-text">10. IoC注解式开发</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#10-1-%E5%9B%9E%E9%A1%BE%E6%B3%A8%E8%A7%A3%E5%BC%80%E5%8F%91"><span class="toc-number">9.1.</span> <span class="toc-text">10.1 回顾注解开发</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#10-1-1%E6%B3%A8%E8%A7%A3%E7%9A%84%E6%84%8F%E4%B9%89"><span class="toc-number">9.1.1.</span> <span class="toc-text">10.1.1注解的意义</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10-1-2-%E6%B3%A8%E8%A7%A3%E4%B8%AD%E5%B1%9E%E6%80%A7%E7%9A%84%E5%AE%9A%E4%B9%89"><span class="toc-number">9.1.2.</span> <span class="toc-text">10.1.2 注解中属性的定义</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10-1-3-%E9%80%9A%E8%BF%87%E5%8F%8D%E5%B0%84%E6%9C%BA%E5%88%B6%E8%AF%BB%E5%8F%96%E6%B3%A8%E8%A7%A3"><span class="toc-number">9.1.3.</span> <span class="toc-text">10.1.3 通过反射机制读取注解</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10-1-4-%E5%AE%8C%E6%95%B4%E4%BB%A3%E7%A0%81"><span class="toc-number">9.1.4.</span> <span class="toc-text">10.1.4 完整代码</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-2-Bean%E7%9A%84%E6%B3%A8%E8%A7%A3%E7%A7%8D%E7%B1%BB"><span class="toc-number">9.2.</span> <span class="toc-text">10.2 Bean的注解种类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-3-%E6%B3%A8%E8%A7%A3%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">9.3.</span> <span class="toc-text">10.3 注解的使用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#10-3-1-%E4%BD%BF%E7%94%A8%E6%B3%A8%E8%A7%A3"><span class="toc-number">9.3.1.</span> <span class="toc-text">10.3.1 使用注解</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10-3-2-%E9%80%89%E6%8B%A9%E6%80%A7%E5%AE%9E%E4%BE%8B%E5%8C%96Bean"><span class="toc-number">9.3.2.</span> <span class="toc-text">10.3.2 选择性实例化Bean</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-4-%E8%B4%9F%E8%B4%A3%E6%B3%A8%E5%85%A5%E7%9A%84%E6%B3%A8%E8%A7%A3"><span class="toc-number">9.4.</span> <span class="toc-text">10.4 负责注入的注解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-5-%E5%85%A8%E6%B3%A8%E8%A7%A3%E5%BC%8F%E5%BC%80%E5%8F%91"><span class="toc-number">9.5.</span> <span class="toc-text">10.5 全注解式开发</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-GoF%E4%B9%8B%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F"><span class="toc-number">10.</span> <span class="toc-text">11. GoF之代理模式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-%E9%9D%A2%E5%90%91%E5%88%87%E9%9D%A2%E7%BC%96%E7%A8%8BAOP"><span class="toc-number">11.</span> <span class="toc-text">12. 面向切面编程AOP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#12-1-AOP%E7%9A%84%E4%BB%8B%E7%BB%8D"><span class="toc-number">11.1.</span> <span class="toc-text">12.1 AOP的介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFAOP"><span class="toc-number">11.1.1.</span> <span class="toc-text">什么是AOP</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#AOP%E5%92%8C%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F"><span class="toc-number">11.1.2.</span> <span class="toc-text">AOP和代理模式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Spring-%E4%B8%AD%E7%9A%84-AOP"><span class="toc-number">11.1.3.</span> <span class="toc-text">Spring 中的 AOP</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-2-AOP%E7%9B%B8%E5%85%B3%E6%9C%AF%E8%AF%AD"><span class="toc-number">11.2.</span> <span class="toc-text">12.2 AOP相关术语</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-3-%E5%88%87%E7%82%B9%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">11.3.</span> <span class="toc-text">12.3 切点表达式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-4-%E4%BD%BF%E7%94%A8Spring%E7%9A%84AOP"><span class="toc-number">11.4.</span> <span class="toc-text">12.4 使用Spring的AOP</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE"><span class="toc-number">11.4.1.</span> <span class="toc-text">配置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%8D%E7%94%A8%E5%92%8C%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F"><span class="toc-number">11.4.2.</span> <span class="toc-text">复用和执行顺序</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%AD%A5%E9%AA%A4"><span class="toc-number">11.4.3.</span> <span class="toc-text">步骤</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81"><span class="toc-number">11.4.4.</span> <span class="toc-text">代码</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%87%E9%9D%A2%E7%B1%BB"><span class="toc-number">11.4.4.1.</span> <span class="toc-text">切面类</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#xml%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">11.4.4.2.</span> <span class="toc-text">xml配置文件</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%A7%E8%A1%8C%E7%BB%93%E6%9E%9C"><span class="toc-number">11.4.5.</span> <span class="toc-text">执行结果</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">11.4.6.</span> <span class="toc-text">总结</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%A8%E6%B3%A8%E8%A7%A3%E5%BC%80%E5%8F%91"><span class="toc-number">11.4.7.</span> <span class="toc-text">全注解开发</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-5-xml%E5%BC%80%E5%8F%91-%E4%B8%8D%E6%8E%A8%E8%8D%90"><span class="toc-number">11.5.</span> <span class="toc-text">12.5 xml开发(不推荐)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-6-%E5%BA%94%E7%94%A8%E6%A1%88%E4%BE%8B"><span class="toc-number">11.6.</span> <span class="toc-text">12.6 应用案例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-Spring%E5%AF%B9%E4%BA%8B%E5%8A%A1%E7%9A%84%E6%94%AF%E6%8C%81-JdbcTemplate"><span class="toc-number">12.</span> <span class="toc-text">13. Spring对事务的支持 (JdbcTemplate)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-Spring6%E6%95%B4%E5%90%88Junit5"><span class="toc-number">13.</span> <span class="toc-text">14. Spring6整合Junit5</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#15-Spring6%E9%9B%86%E6%88%90Mabatis"><span class="toc-number">14.</span> <span class="toc-text">15. Spring6集成Mabatis</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#16-Spring%E4%B8%AD%E7%9A%84%E5%85%AB%E5%A4%A7%E6%A8%A1%E5%BC%8F"><span class="toc-number">15.</span> <span class="toc-text">16. Spring中的八大模式</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/08/Project/Big-Market/%E8%BF%87%E7%A8%8B%E7%AC%94%E8%AE%B0/9.%20%E4%BD%BF%E7%94%A8%E8%B4%A3%E4%BB%BB%E9%93%BE%E5%A4%84%E7%90%86%E6%8A%BD%E5%A5%96%E8%A7%84%E5%88%99/" title="无标题">无标题</a><time datetime="2025-07-08T15:03:04.855Z" title="发表于 2025-07-08 23:03:04">2025-07-08</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/08/Project/Big-Market/%E8%BF%87%E7%A8%8B%E7%AC%94%E8%AE%B0/8.%20%E6%8A%BD%E5%A5%96%E4%B8%AD%E7%BD%AE%E8%A7%84%E5%88%99%E8%BF%87%E6%BB%A4/" title="无标题">无标题</a><time datetime="2025-07-08T15:03:04.854Z" title="发表于 2025-07-08 23:03:04">2025-07-08</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/08/Project/Big-Market/%E8%BF%87%E7%A8%8B%E7%AC%94%E8%AE%B0/7.%20%E6%8A%BD%E5%A5%96%E5%89%8D%E7%BD%AE%E8%A7%84%E5%88%99%E8%BF%87%E6%BB%A4/" title="无标题">无标题</a><time datetime="2025-07-08T15:03:04.853Z" title="发表于 2025-07-08 23:03:04">2025-07-08</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/08/Project/Big-Market/%E8%BF%87%E7%A8%8B%E7%AC%94%E8%AE%B0/6.%20%E6%9D%83%E9%87%8D%E8%A3%85%E9%85%8D%E5%A4%84%E7%90%86/" title="无标题">无标题</a><time datetime="2025-07-08T15:03:04.852Z" title="发表于 2025-07-08 23:03:04">2025-07-08</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/08/Project/Big-Market/%E8%BF%87%E7%A8%8B%E7%AC%94%E8%AE%B0/26.%20%E7%A7%AF%E5%88%86%E9%A2%86%E5%9F%9F%E8%B0%83%E9%A2%9D%E6%9C%8D%E5%8A%A1/" title="无标题">无标题</a><time datetime="2025-07-08T15:03:04.847Z" title="发表于 2025-07-08 23:03:04">2025-07-08</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(https://raw.githubusercontent.com/fang-tech/Pic/main/img/psc.jpg);"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;2025 By Func</span><span class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.4.1</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">简</button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><div class="js-pjax"><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'
  const option = null

  const commentCount = n => {
    const isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
    if (isCommentCount) {
      isCommentCount.textContent= n
    }
  }

  const initGitalk = (el, path) => {
    if (isShuoshuo) {
      window.shuoshuoComment.destroyGitalk = () => {
        if (el.children.length) {
          el.innerHTML = ''
          el.classList.add('no-comment')
        }
      }
    }

    const gitalk = new Gitalk({
      clientID: 'Ov23li4bXLe7MUGkzYiL',
      clientSecret: '6e07175d5780251b166904c518448940a5214fb1',
      repo: 'fang-tech.github.io',
      owner: 'fang-tech',
      admin: ['fang-tech'],
      updateCountCallback: commentCount,
      ...option,
      id: isShuoshuo ? path : (option && option.id) || '50d30e33224125f992b756b785c6f8c3'
    })

    gitalk.render('gitalk-container')
  }

  const loadGitalk = async(el, path) => {
    if (typeof Gitalk === 'function') initGitalk(el, path)
    else {
      await btf.getCSS('https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css')
      await btf.getScript('https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.js')
      initGitalk(el, path)
    }
  }

  if (isShuoshuo) {
    'Gitalk' === 'Gitalk'
      ? window.shuoshuoComment = { loadComment: loadGitalk }
      : window.loadOtherComment = loadGitalk
    return
  }

  if ('Gitalk' === 'Gitalk' || !false) {
    if (false) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
    else loadGitalk()
  } else {
    window.loadOtherComment = loadGitalk
  }
})()</script></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>